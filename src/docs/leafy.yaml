openapi: 3.0.1
info:
  title: InnerEcho API - (1) User
  description: InnerEcho ì„œë¹„ìŠ¤ì˜ ì‚¬ìš©ì ì¸ì¦ ë° ì •ë³´ ì¡°íšŒ API ëª…ì„¸ì„œì…ë‹ˆë‹¤.
  version: 1.0.1

servers:
  - url: http://localhost:3002
    description: ë¡œì»¬ ê°œë°œ ì„œë²„
  - url: https://leafy.wolyong.cloud
    description: í”„ë¡œë•ì…˜ ì„œë²„

tags:
  - name: User
    description: "ğŸ§‘â€ğŸ¤â€ğŸ§‘ ì‚¬ìš©ì ë¦¬ì†ŒìŠ¤ ê´€ë¦¬ API (íšŒì›ê°€ì…, ì •ë³´ ì¡°íšŒ/ìˆ˜ì •/ì‚­ì œ)"
  - name: Auth
    description: "ğŸ” ì¸ì¦ ë¦¬ì†ŒìŠ¤ ê´€ë¦¬ API (ë¡œê·¸ì¸, ì„¸ì…˜ ë°œê¸‰, ì´ë©”ì¼ ì¸ì¦)"
  - name: Auth V2
    description: "ğŸ”âœ¨ ì¸ì¦ V2 API (Access Token + Refresh Token, ë³´ì•ˆ ê°•í™”)"
  - name: Emotion
    description: "ğŸ˜Š ì‚¬ìš©ì ê°ì • ìƒíƒœ ë¦¬ì†ŒìŠ¤ ê´€ë¦¬ API"
  - name: Plant
    description: "ğŸŒ± ì‚¬ìš©ìì˜ ì‹ë¬¼ ìƒíƒœ(ë ˆë²¨, ê²½í—˜ì¹˜, í˜¸ê°ë„) ì¡°íšŒ API"
  - name: Chat
    description: "ğŸ’¬ ì‹ë¬¼ ì±—ë´‡ê³¼ì˜ ëŒ€í™” ë° ì´ì „ ëŒ€í™” ê¸°ë¡ ì¡°íšŒ API"
  - name: Diary
    description: "ğŸ“” ì„±ì¥ ì¼ê¸° ë¦¬ì†ŒìŠ¤ ê´€ë¦¬ API (ëŒ“ê¸€ í¬í•¨)"
  - name: Friend
    description: "ğŸ‘¥ ì¹œêµ¬ ë¦¬ì†ŒìŠ¤ ê´€ë¦¬ API"
  - name: Mission
    description: "ğŸ¯ ë¯¸ì…˜ ë¦¬ì†ŒìŠ¤ ê´€ë¦¬ API"
  - name: Speech
    description: "ğŸ¤ ìŒì„± ì¸ì‹ ë° í•©ì„± API (STT, TTS)"
  - name: Realtime Speech
    description: "ğŸ™ï¸ OpenAI Realtime APIë¥¼ ì‚¬ìš©í•œ ì‹¤ì‹œê°„ ìŒì„± ëŒ€í™” (WebSocket)"
  - name: Multiplayer AR
    description: "ğŸŒ AR ë©€í‹°í”Œë ˆì´ì–´ WebSocket API (ì‹¤ì‹œê°„ AR ìºë¦­í„° ë™ê¸°í™”)"

# ===============================================================
# == Paths (Endpoints)
# ===============================================================
paths:
  # ==================== User APIs ====================
  /users:
    post:
      tags:
        - User
      summary: ì‚¬ìš©ì ìƒì„± (íšŒì›ê°€ì…)
      description: ìƒˆë¡œìš´ ì‚¬ìš©ì ë¦¬ì†ŒìŠ¤ë¥¼ ìƒì„±í•©ë‹ˆë‹¤. ì„±ê³µ ì‹œ, í•´ë‹¹ ì‚¬ìš©ìì—ê²Œ 'ê¸ˆìª½ì´'ë¼ëŠ” ì´ë¦„ì˜ ê¸°ë³¸ ì‹ë¬¼ë„ í•¨ê»˜ ìƒì„±ë©ë‹ˆë‹¤.
      requestBody:
        description: íšŒì›ê°€ì…ì— í•„ìš”í•œ ì‚¬ìš©ì ì •ë³´
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UserRegisterRequest'
      responses:
        '200':
          description: ì‚¬ìš©ì ìƒì„± ì„±ê³µ
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UserResponse'
        '400':
          description: í•„ìˆ˜ í•„ë“œê°€ ëˆ„ë½ë˜ì—ˆê±°ë‚˜, ì´ë©”ì¼ ë˜ëŠ” ë‹‰ë„¤ì„ì´ ì´ë¯¸ ì¡´ì¬í•˜ëŠ” ê²½ìš°
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
              example:
                code: 400
                msg: "ì´ë¯¸ ì¡´ì¬í•˜ëŠ” ì´ë©”ì¼ì…ë‹ˆë‹¤."
        '500':
          $ref: '#/components/responses/ServerError'

  /users/{userId}:
    get:
      tags:
        - User
      summary: íŠ¹ì • ì‚¬ìš©ì ì •ë³´ ì¡°íšŒ
      description: ì‚¬ìš©ì IDë¡œ íŠ¹ì • ì‚¬ìš©ì ë¦¬ì†ŒìŠ¤ì˜ ì •ë³´ë¥¼ ì¡°íšŒí•©ë‹ˆë‹¤.
      parameters:
        - in: path
          name: userId
          required: true
          schema:
            type: integer
          description: ì¡°íšŒí•  ì‚¬ìš©ìì˜ ID
      responses:
        '200':
          description: ì‚¬ìš©ì ì •ë³´ ì¡°íšŒ ì„±ê³µ
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UserResponse'
        '404':
          description: í•´ë‹¹ ì‚¬ìš©ìë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŒ
        '500':
          $ref: '#/components/responses/ServerError'

    put:
      tags:
        - User
      summary: ì‚¬ìš©ì ì •ë³´ ìˆ˜ì •
      description: íŠ¹ì • ì‚¬ìš©ì ë¦¬ì†ŒìŠ¤ì˜ ì •ë³´ë¥¼ ìˆ˜ì •í•©ë‹ˆë‹¤.
      parameters:
        - in: path
          name: userId
          required: true
          schema:
            type: integer
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                userName:
                  type: string
                userGender:
                  type: string
                state:
                  type: string
      responses:
        '200':
          description: ì‚¬ìš©ì ì •ë³´ ìˆ˜ì • ì„±ê³µ
        '404':
          description: í•´ë‹¹ ì‚¬ìš©ìë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŒ
        '500':
          $ref: '#/components/responses/ServerError'

    delete:
      tags:
        - User
      summary: ì‚¬ìš©ì ì‚­ì œ
      description: íŠ¹ì • ì‚¬ìš©ì ë¦¬ì†ŒìŠ¤ë¥¼ ì‚­ì œí•©ë‹ˆë‹¤.
      parameters:
        - in: path
          name: userId
          required: true
          schema:
            type: integer
      responses:
        '200':
          description: ì‚¬ìš©ì ì‚­ì œ ì„±ê³µ
        '404':
          description: í•´ë‹¹ ì‚¬ìš©ìë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŒ
        '500':
          $ref: '#/components/responses/ServerError'

  # ==================== Emotion APIs ====================
  /emotions:
    get:
      tags:
        - Emotion
      summary: ì‚¬ìš©ìì˜ í˜„ì¬ ê°ì • ìƒíƒœ ì¡°íšŒ
      description: |
        ì¸ì¦ëœ ì‚¬ìš©ìì˜ í˜„ì¬ ì„¤ì •ëœ ê°ì •(state) ê°’ì„ ì¡°íšŒí•©ë‹ˆë‹¤.
        Access Tokenì—ì„œ userIdë¥¼ ìë™ìœ¼ë¡œ ì¶”ì¶œí•˜ì—¬ ì‚¬ìš©í•©ë‹ˆë‹¤.
      security:
        - BearerAuth: []
      responses:
        '200':
          description: ê°ì • ì¡°íšŒ ì„±ê³µ
          content:
            application/json:
              schema:
                type: object
                properties:
                  code:
                    type: integer
                    example: 200
                  data:
                    type: object
                    properties:
                      emotion:
                        type: string
                        description: "ì‚¬ìš©ìì˜ í˜„ì¬ ê°ì • ìƒíƒœ (ì˜ˆ: í–‰ë³µ, ìŠ¬í””)"
                        example: "í–‰ë³µ"
                  msg:
                    type: string
                    example: "Ok"
        '401':
          description: ì¸ì¦ ì‹¤íŒ¨ (í† í° ì—†ìŒ ë˜ëŠ” ìœ íš¨í•˜ì§€ ì•ŠìŒ)
        '404':
          description: í•´ë‹¹ ì‚¬ìš©ìë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŒ
        '500':
          $ref: '#/components/responses/ServerError'

  /emotions/latest:
    get:
      tags:
        - Emotion
      summary: ìµœì‹  ê°ì • ë¶„ì„ ê²°ê³¼ ì¡°íšŒ
      description: |
        ìµœì‹  ëŒ€í™” ë¶„ì„ ê¸°ë¡ì—ì„œ ê°ì •, ì›ë¬¸ ë©”ì‹œì§€, factor(ì£¼ìš” ìš”ì¸)ì„ ì¡°íšŒí•©ë‹ˆë‹¤.
        ê°ì • ë¶„ì„ ë°ì´í„°ê°€ ì—†ìœ¼ë©´ `data`ëŠ” `null`ì´ ë©ë‹ˆë‹¤.
      security:
        - BearerAuth: []
      responses:
        '200':
          description: ìµœì‹  ê°ì • ë¶„ì„ ì¡°íšŒ ì„±ê³µ
          content:
            application/json:
              schema:
                type: object
                properties:
                  code:
                    type: integer
                    example: 200
                  data:
                    oneOf:
                      - type: 'null'
                      - type: object
                        properties:
                          analysisId:
                            type: integer
                            description: ë¶„ì„ ë ˆì½”ë“œ ID
                            example: 42
                          historyId:
                            type: integer
                            nullable: true
                            description: ì—°ê²°ëœ ëŒ€í™” íˆìŠ¤í† ë¦¬ ID
                            example: 105
                          emotion:
                            type: string
                            nullable: true
                            description: ê°ì • ë¶„ì„ ê²°ê³¼
                            example: "í–‰ë³µ"
                          message:
                            type: string
                            nullable: true
                            description: ê°ì • ë¶„ì„ì´ ìˆ˜í–‰ëœ ì‚¬ìš©ì ë©”ì‹œì§€
                            example: "ì˜¤ëŠ˜ í•˜ë£¨ê°€ ë„ˆë¬´ ì¦ê±°ì› ì–´!"
                          factor:
                            type: string
                            nullable: true
                            description: ê°ì •ì— ì˜í–¥ì„ ì¤€ ì£¼ìš” ìš”ì¸
                            example: "ì¦ê±°ìš´ ê²½í—˜"
                          plantId:
                            type: integer
                            nullable: true
                            description: ì—°ê´€ëœ ì‹ë¬¼ ID
                            example: 12
                          analyzedAt:
                            type: string
                            format: date-time
                            description: ë¶„ì„ì´ ì €ì¥ëœ ì‹œê°„
                          sendDate:
                            type: string
                            format: date-time
                            nullable: true
                            description: ë©”ì‹œì§€ê°€ ì „ì†¡ëœ ì‹œê°„
                  msg:
                    type: string
                    example: "Ok"
        '401':
          description: ì¸ì¦ ì‹¤íŒ¨ (í† í° ì—†ìŒ ë˜ëŠ” ìœ íš¨í•˜ì§€ ì•ŠìŒ)
        '500':
          $ref: '#/components/responses/ServerError'

  /emotions/history/monthly:
    get:
      tags:
        - Emotion
      summary: ìµœê·¼ í•œ ë‹¬ ê°ì • ë¶„ì„ ê¸°ë¡ ì¡°íšŒ
      description: |
        ì‚¬ìš©ìì˜ ìµœê·¼ í•œ ë‹¬ ë™ì•ˆ ì €ì¥ëœ ê°ì • ë¶„ì„ ê¸°ë¡ì„ ìµœì‹ ìˆœìœ¼ë¡œ ì¡°íšŒí•©ë‹ˆë‹¤.
        ê° í•­ëª©ì€ ìµœì‹  ê°ì • ì¡°íšŒ API(`GET /emotions/latest`)ì™€ ë™ì¼í•œ í•„ë“œë¥¼ í¬í•¨í•©ë‹ˆë‹¤.
      security:
        - BearerAuth: []
      responses:
        '200':
          description: ê°ì • ë¶„ì„ ê¸°ë¡ ì¡°íšŒ ì„±ê³µ
          content:
            application/json:
              schema:
                type: object
                properties:
                  code:
                    type: integer
                    example: 200
                  data:
                    type: array
                    items:
                      type: object
                      properties:
                        analysisId:
                          type: integer
                          description: ë¶„ì„ ë ˆì½”ë“œ ID
                          example: 108
                        historyId:
                          type: integer
                          nullable: true
                          description: ì—°ê²°ëœ ëŒ€í™” íˆìŠ¤í† ë¦¬ ID
                          example: 205
                        emotion:
                          type: string
                          nullable: true
                          description: ê°ì • ë¶„ì„ ê²°ê³¼
                          example: "í–‰ë³µ"
                        message:
                          type: string
                          nullable: true
                          description: ê°ì • ë¶„ì„ì´ ìˆ˜í–‰ëœ ì‚¬ìš©ì ë©”ì‹œì§€
                          example: "ì˜¤ëŠ˜ì€ ê¸°ë¶„ì´ ì •ë§ ì¢‹ì•„!"
                        factor:
                          type: string
                          nullable: true
                          description: ê°ì •ì— ì˜í–¥ì„ ì¤€ ì£¼ìš” ìš”ì¸
                          example: "ì¹œêµ¬ì™€ì˜ ë§Œë‚¨"
                        plantId:
                          type: integer
                          nullable: true
                          description: ì—°ê´€ëœ ì‹ë¬¼ ID
                          example: 7
                        analyzedAt:
                          type: string
                          format: date-time
                          description: ë¶„ì„ì´ ì €ì¥ëœ ì‹œê°„
                        sendDate:
                          type: string
                          format: date-time
                          nullable: true
                          description: ë©”ì‹œì§€ê°€ ì „ì†¡ëœ ì‹œê°„
                  msg:
                    type: string
                    example: "Ok"
        '401':
          description: ì¸ì¦ ì‹¤íŒ¨ (í† í° ì—†ìŒ ë˜ëŠ” ìœ íš¨í•˜ì§€ ì•ŠìŒ)
        '500':
          $ref: '#/components/responses/ServerError'

  # ==================== Auth APIs ====================
  /auth/sessions:
    post:
      tags:
        - Auth
      summary: ì„¸ì…˜ ìƒì„± (ë¡œê·¸ì¸)
      description: ì´ë©”ì¼ê³¼ ë¹„ë°€ë²ˆí˜¸ë¡œ ì‚¬ìš©ìë¥¼ ì¸ì¦í•˜ê³ , API ì ‘ê·¼ì„ ìœ„í•œ JWT í† í° ë¦¬ì†ŒìŠ¤ë¥¼ ìƒì„±í•©ë‹ˆë‹¤.
      requestBody:
        description: ë¡œê·¸ì¸ì— í•„ìš”í•œ ì´ë©”ì¼ê³¼ ë¹„ë°€ë²ˆí˜¸
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UserLoginRequest'
      responses:
        '200':
          description: ì„¸ì…˜ ìƒì„± ì„±ê³µ. JWT í† í°ì„ ë°˜í™˜í•©ë‹ˆë‹¤.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/TokenResponse'
        '401':
          description: ì´ë©”ì¼ì´ ì¡´ì¬í•˜ì§€ ì•Šê±°ë‚˜ ë¹„ë°€ë²ˆí˜¸ê°€ ì¼ì¹˜í•˜ì§€ ì•ŠëŠ” ê²½ìš°
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
              example:
                code: 401
                msg: "ë¹„ë°€ë²ˆí˜¸ê°€ ì¼ì¹˜í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤."
        '500':
          $ref: '#/components/responses/ServerError'

    get:
      tags:
        - Auth
      summary: ì„¸ì…˜ ê²€ì¦ (JWT í† í° ìœ íš¨ì„± ê²€ì¦)
      description: HTTP í—¤ë”ì˜ `Authorization` í•„ë“œì— ë‹´ê¸´ JWT í† í°ì„ ê²€ì¦í•˜ê³ , ìœ íš¨í•˜ë‹¤ë©´ í† í°ì— ë‹´ê¸´ ì‚¬ìš©ì ì •ë³´ë¥¼ ë°˜í™˜í•©ë‹ˆë‹¤. (ë¡œê·¸ì¸ ìœ ì§€ í™•ì¸ìš©)
      security:
        - BearerAuth: []
      responses:
        '200':
          description: í† í°ì´ ìœ íš¨í•œ ê²½ìš°, ë””ì½”ë”©ëœ ì‚¬ìš©ì ì •ë³´ë¥¼ ë°˜í™˜í•©ë‹ˆë‹¤.
          content:
            application/json:
              schema:
                type: object
                properties:
                  code:
                    type: integer
                    example: 200
                  data:
                    $ref: '#/components/schemas/DecodedToken'
                  msg:
                    type: string
                    example: "Ok"
        '401':
          $ref: '#/components/responses/UnauthorizedError'

  /auth/verifications:
    post:
      tags:
        - Auth
      summary: ì´ë©”ì¼ ì¸ì¦ë²ˆí˜¸ ìƒì„± ë° ë°œì†¡
      description: íšŒì›ê°€ì… ì‹œ ë³¸ì¸ ì¸ì¦ì„ ìœ„í•´ ì´ë©”ì¼ ì¸ì¦ë²ˆí˜¸ ë¦¬ì†ŒìŠ¤ë¥¼ ìƒì„±í•˜ê³  ë°œì†¡í•©ë‹ˆë‹¤.
      requestBody:
        description: ì¸ì¦ë²ˆí˜¸ë¥¼ ë°œì†¡í•  ì´ë©”ì¼ ì£¼ì†Œ
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - email
              properties:
                email:
                  type: string
                  format: email
                  description: "ì¸ì¦ë²ˆí˜¸ë¥¼ ë°›ì„ ì´ë©”ì¼ ì£¼ì†Œ"
                  example: "test@example.com"
      responses:
        '200':
          description: ì¸ì¦ë²ˆí˜¸ ë°œì†¡ ì„±ê³µ
          content:
            application/json:
              schema:
                type: object
                properties:
                  code:
                    type: integer
                    example: 200
                  data:
                    type: integer
                    description: "ìƒì„±ëœ 6ìë¦¬ ì¸ì¦ë²ˆí˜¸"
                    example: 123456
                  msg:
                    type: string
                    example: "SendMail"
        '500':
          $ref: '#/components/responses/ServerError'

  # ==================== Auth V2 APIs ====================
  /auth/v2/register:
    post:
      tags:
        - Auth V2
      summary: íšŒì›ê°€ì… (Access Token + Refresh Token ë°œê¸‰)
      description: |
        V2 ì¸ì¦ ì‹œìŠ¤í…œì„ ì‚¬ìš©í•œ íšŒì›ê°€ì…ì…ë‹ˆë‹¤.
        íšŒì›ê°€ì…ê³¼ ë™ì‹œì— Access Tokenê³¼ Refresh Tokenì„ ë°œê¸‰í•˜ì—¬ ì¦‰ì‹œ ë¡œê·¸ì¸ ìƒíƒœê°€ ë©ë‹ˆë‹¤.
        íšŒì›ê°€ì… ì‹œ ì‚¬ìš©ìê°€ ì§€ì •í•œ ì´ë¦„ì˜ ì‹ë¬¼ì´ ìë™ìœ¼ë¡œ ìƒì„±ë©ë‹ˆë‹¤.
        - Access Token (15ë¶„ ìœ íš¨): API ìš”ì²­ì— ì‚¬ìš©
        - Refresh Token (7ì¼ ìœ íš¨): Access Token ê°±ì‹ ì— ì‚¬ìš©
        - Rate Limiting: 1ë¶„ì— 10íšŒë¡œ ì œí•œ
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - email
                - password
                - userName
                - userGender
                - plantNickname
              properties:
                email:
                  type: string
                  format: email
                  example: "newuser@example.com"
                password:
                  type: string
                  format: password
                  example: "password123!"
                userName:
                  type: string
                  example: "í™ê¸¸ë™"
                userGender:
                  type: string
                  example: "male"
                plantNickname:
                  type: string
                  description: "ì‚¬ìš©ìê°€ í‚¤ìš¸ ì‹ë¬¼ì˜ ì´ë¦„"
                  example: "ê¸ˆìª½ì´"
      responses:
        '201':
          description: íšŒì›ê°€ì… ì„±ê³µ, Access Token ë° Refresh Token ë°œê¸‰
          content:
            application/json:
              schema:
                type: object
                properties:
                  code:
                    type: integer
                    example: 201
                  message:
                    type: string
                    example: "Registration successful"
                  data:
                    type: object
                    properties:
                      accessToken:
                        type: string
                        description: "15ë¶„ ìœ íš¨í•œ Access Token"
                        example: "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."
                      refreshToken:
                        type: string
                        description: "7ì¼ ìœ íš¨í•œ Refresh Token"
                        example: "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."
                      tokenType:
                        type: string
                        example: "Bearer"
                      expiresIn:
                        type: string
                        example: "15m"
                      user:
                        type: object
                        properties:
                          userId:
                            type: integer
                            example: 1
                          userEmail:
                            type: string
                            example: "newuser@example.com"
                          userName:
                            type: string
                            example: "í™ê¸¸ë™"
        '400':
          description: ì…ë ¥ê°’ ì˜¤ë¥˜ ë˜ëŠ” ì´ë©”ì¼/ë‹‰ë„¤ì„ì´ ì´ë¯¸ ì¡´ì¬í•¨
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AuthV2ErrorResponse'
              examples:
                missingFields:
                  value:
                    code: 400
                    message: "All fields are required"
                    error: "MISSING_FIELDS"
                emailExists:
                  value:
                    code: 400
                    message: "Email already exists"
                    error: "ExistEmail"
                nicknameExists:
                  value:
                    code: 400
                    message: "Nickname already exists"
                    error: "ExistNickName"
        '429':
          description: íšŒì›ê°€ì… ì‹œë„ íšŸìˆ˜ ì´ˆê³¼
          content:
            application/json:
              schema:
                type: object
                properties:
                  code:
                    type: integer
                    example: 429
                  message:
                    type: string
                    example: "Too many registration attempts, please try again later"
                  error:
                    type: string
                    example: "RATE_LIMIT_EXCEEDED"
        '500':
          $ref: '#/components/responses/ServerError'

  /auth/v2/login:
    post:
      tags:
        - Auth V2
      summary: ë¡œê·¸ì¸ (Access Token + Refresh Token ë°œê¸‰)
      description: |
        V2 ì¸ì¦ ì‹œìŠ¤í…œì„ ì‚¬ìš©í•œ ë¡œê·¸ì¸ì…ë‹ˆë‹¤.
        - Access Token (15ë¶„ ìœ íš¨): API ìš”ì²­ì— ì‚¬ìš©
        - Refresh Token (7ì¼ ìœ íš¨): Access Token ê°±ì‹ ì— ì‚¬ìš©
        - Rate Limiting: 5ë¶„ì— 5íšŒë¡œ ì œí•œ
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - email
                - password
              properties:
                email:
                  type: string
                  format: email
                  example: "innerecho@example.com"
                password:
                  type: string
                  format: password
                  example: "password123!"
      responses:
        '200':
          description: ë¡œê·¸ì¸ ì„±ê³µ
          content:
            application/json:
              schema:
                type: object
                properties:
                  code:
                    type: integer
                    example: 200
                  message:
                    type: string
                    example: "Login successful"
                  data:
                    type: object
                    properties:
                      accessToken:
                        type: string
                        description: "15ë¶„ ìœ íš¨í•œ Access Token"
                        example: "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."
                      refreshToken:
                        type: string
                        description: "7ì¼ ìœ íš¨í•œ Refresh Token"
                        example: "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."
                      tokenType:
                        type: string
                        example: "Bearer"
                      expiresIn:
                        type: string
                        example: "15m"
        '400':
          description: ì´ë©”ì¼ ë˜ëŠ” ë¹„ë°€ë²ˆí˜¸ ì˜¤ë¥˜
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AuthV2ErrorResponse'
              examples:
                emailNotExist:
                  value:
                    code: 400
                    message: "Email does not exist"
                    error: "NOT_EXIST_EMAIL"
                incorrectPassword:
                  value:
                    code: 400
                    message: "Incorrect password"
                    error: "INCORRECT_PASSWORD"
        '429':
          description: ë¡œê·¸ì¸ ì‹œë„ íšŸìˆ˜ ì´ˆê³¼
          content:
            application/json:
              schema:
                type: object
                properties:
                  code:
                    type: integer
                    example: 429
                  message:
                    type: string
                    example: "Too many login attempts, please try again after 5 minutes"
                  error:
                    type: string
                    example: "RATE_LIMIT_EXCEEDED"
                  retryAfter:
                    type: string
                    example: "300 seconds"
        '500':
          $ref: '#/components/responses/ServerError'

  /auth/v2/refresh:
    post:
      tags:
        - Auth V2
      summary: Access Token ê°±ì‹ 
      description: |
        Refresh Tokenì„ ì‚¬ìš©í•˜ì—¬ ìƒˆë¡œìš´ Access Tokenì„ ë°œê¸‰ë°›ìŠµë‹ˆë‹¤.
        Access Tokenì´ ë§Œë£Œë˜ì—ˆì„ ë•Œ ì‚¬ìš©í•©ë‹ˆë‹¤.
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - refreshToken
              properties:
                refreshToken:
                  type: string
                  description: "ë¡œê·¸ì¸ ì‹œ ë°œê¸‰ë°›ì€ Refresh Token"
                  example: "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."
      responses:
        '200':
          description: í† í° ê°±ì‹  ì„±ê³µ
          content:
            application/json:
              schema:
                type: object
                properties:
                  code:
                    type: integer
                    example: 200
                  message:
                    type: string
                    example: "Token refreshed successfully"
                  data:
                    type: object
                    properties:
                      accessToken:
                        type: string
                        description: "ìƒˆë¡œ ë°œê¸‰ëœ Access Token"
                        example: "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."
                      tokenType:
                        type: string
                        example: "Bearer"
                      expiresIn:
                        type: string
                        example: "15m"
        '401':
          description: Refresh Tokenì´ ìœ íš¨í•˜ì§€ ì•Šê±°ë‚˜ ë§Œë£Œë¨
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AuthV2ErrorResponse'
              examples:
                expired:
                  value:
                    code: 401
                    message: "Refresh token has expired"
                    error: "REFRESH_TOKEN_EXPIRED"
                revoked:
                  value:
                    code: 401
                    message: "Refresh token has been revoked"
                    error: "REFRESH_TOKEN_REVOKED"
                notFound:
                  value:
                    code: 401
                    message: "Invalid refresh token"
                    error: "REFRESH_TOKEN_NOT_FOUND"
                invalid:
                  value:
                    code: 401
                    message: "Invalid refresh token format"
                    error: "INVALID_REFRESH_TOKEN"
                userNotFound:
                  value:
                    code: 404
                    message: "User not found"
                    error: "USER_NOT_FOUND"
        '500':
          $ref: '#/components/responses/ServerError'

  /auth/v2/logout:
    post:
      tags:
        - Auth V2
      summary: ë¡œê·¸ì•„ì›ƒ
      description: |
        í˜„ì¬ Access Tokenê³¼ Refresh Tokenì„ ë¬´íš¨í™”í•©ë‹ˆë‹¤.
        ë¡œê·¸ì•„ì›ƒ í›„ì—ëŠ” í•´ë‹¹ í† í°ë“¤ì„ ì‚¬ìš©í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.
      security:
        - BearerAuth: []
      requestBody:
        required: false
        content:
          application/json:
            schema:
              type: object
              properties:
                refreshToken:
                  type: string
                  description: "ë¬´íš¨í™”í•  Refresh Token (ì„ íƒì‚¬í•­)"
                  example: "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."
      responses:
        '200':
          description: ë¡œê·¸ì•„ì›ƒ ì„±ê³µ
          content:
            application/json:
              schema:
                type: object
                properties:
                  code:
                    type: integer
                    example: 200
                  message:
                    type: string
                    example: "Logged out successfully"
        '400':
          description: Access Tokenì´ ì—†ìŒ
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AuthV2ErrorResponse'
              example:
                code: 400
                message: "Access token is required in Authorization header"
                error: "MISSING_TOKEN"
        '500':
          $ref: '#/components/responses/ServerError'

  /auth/v2/verify:
    get:
      tags:
        - Auth V2
      summary: í† í° ê²€ì¦ ë° ì‚¬ìš©ì ì •ë³´ ì¡°íšŒ
      description: |
        í˜„ì¬ Access Tokenì´ ìœ íš¨í•œì§€ ê²€ì¦í•˜ê³ , í† í°ì— í¬í•¨ëœ ì‚¬ìš©ì ì •ë³´ë¥¼ ë°˜í™˜í•©ë‹ˆë‹¤.
        ë¡œê·¸ì¸ ìƒíƒœ í™•ì¸ ë° ì‚¬ìš©ì ì •ë³´ ì¡°íšŒì— ì‚¬ìš©í•©ë‹ˆë‹¤.
      security:
        - BearerAuth: []
      responses:
        '200':
          description: í† í°ì´ ìœ íš¨í•¨
          content:
            application/json:
              schema:
                type: object
                properties:
                  code:
                    type: integer
                    example: 200
                  message:
                    type: string
                    example: "Token is valid"
                  data:
                    type: object
                    properties:
                      userId:
                        type: integer
                        example: 1
                      userEmail:
                        type: string
                        example: "innerecho@example.com"
                      userName:
                        type: string
                        example: "ê¹€Inner"
                      state:
                        type: string
                        example: "ì¤‘ë¦½"
        '401':
          description: í† í°ì´ ìœ íš¨í•˜ì§€ ì•Šê±°ë‚˜ ë§Œë£Œë¨
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AuthV2ErrorResponse'
              examples:
                expired:
                  value:
                    code: 401
                    message: "Access token has expired"
                    error: "TOKEN_EXPIRED"
                revoked:
                  value:
                    code: 401
                    message: "Token has been revoked (logged out)"
                    error: "TOKEN_REVOKED"
                invalid:
                  value:
                    code: 401
                    message: "Invalid token format"
                    error: "INVALID_TOKEN"

  /auth/v2/revoke-all:
    post:
      tags:
        - Auth V2
      summary: ëª¨ë“  ì„¸ì…˜ ë¬´íš¨í™” (ê°•ì œ ë¡œê·¸ì•„ì›ƒ)
      description: |
        í˜„ì¬ ì‚¬ìš©ìì˜ ëª¨ë“  Refresh Tokenì„ ë¬´íš¨í™”í•˜ì—¬ ëª¨ë“  ë””ë°”ì´ìŠ¤ì—ì„œ ê°•ì œ ë¡œê·¸ì•„ì›ƒí•©ë‹ˆë‹¤.
        ë³´ì•ˆ ìœ„í˜‘ì´ ê°ì§€ë˜ì—ˆì„ ë•Œ ì‚¬ìš©í•©ë‹ˆë‹¤.
      security:
        - BearerAuth: []
      responses:
        '200':
          description: ëª¨ë“  ì„¸ì…˜ ë¬´íš¨í™” ì„±ê³µ
          content:
            application/json:
              schema:
                type: object
                properties:
                  code:
                    type: integer
                    example: 200
                  message:
                    type: string
                    example: "All sessions have been revoked"
        '401':
          description: ì¸ì¦ ì‹¤íŒ¨
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AuthV2ErrorResponse'
              example:
                code: 401
                message: "Authentication required"
                error: "AUTHENTICATION_REQUIRED"
        '500':
          $ref: '#/components/responses/ServerError'


  # -------------------- Plant State APIs --------------------
  /plant:
    get:
      tags:
        - Plant
      summary: ì‚¬ìš©ìì˜ ì‹ë¬¼ ëª©ë¡ ì¡°íšŒ
      description: |
        ì¸ì¦ëœ ì‚¬ìš©ìê°€ ì†Œìœ í•œ ì‹ë¬¼ ì •ë³´ë¥¼ ì¡°íšŒí•©ë‹ˆë‹¤.
        Access Tokenì—ì„œ userIdë¥¼ ìë™ìœ¼ë¡œ ì¶”ì¶œí•˜ì—¬ ì‚¬ìš©í•©ë‹ˆë‹¤.
      security:
        - BearerAuth: []
      responses:
        '200':
          description: ì‹ë¬¼ ì •ë³´ ì¡°íšŒ ì„±ê³µ
          content:
            application/json:
              schema:
                type: object
                properties:
                  code:
                    type: integer
                    example: 200
                  data:
                    type: object
                    properties:
                      plantId:
                        type: integer
                        description: ì‹ë¬¼ ê³ ìœ  ID
                        example: 1
                      plantName:
                        type: string
                        description: ì‹ë¬¼ ì´ë¦„ (ë‹‰ë„¤ì„)
                        example: "ê¸ˆìª½ì´"
                      level:
                        type: integer
                        description: ì‹ë¬¼ ë ˆë²¨
                        example: 5
                      experience:
                        type: integer
                        description: í˜„ì¬ ê²½í—˜ì¹˜
                        example: 120
                      likeability:
                        type: integer
                        description: í˜¸ê°ë„ (0-100)
                        example: 75
                  msg:
                    type: string
                    example: "Ok"
        '401':
          description: ì¸ì¦ ì‹¤íŒ¨ (í† í° ì—†ìŒ ë˜ëŠ” ìœ íš¨í•˜ì§€ ì•ŠìŒ)
          content:
            application/json:
              schema:
                type: object
                properties:
                  code:
                    type: integer
                    example: 401
                  msg:
                    type: string
                    example: "Unauthorized"
        '404':
          description: í•´ë‹¹ ì‚¬ìš©ìì˜ ì‹ë¬¼ì„ ì°¾ì„ ìˆ˜ ì—†ìŒ
          content:
            application/json:
              schema:
                type: object
                properties:
                  code:
                    type: integer
                    example: 404
                  msg:
                    type: string
                    example: "Plant not found"
        '500':
          $ref: '#/components/responses/ServerError'

  /plant/state/{plantId}:
    get:
      tags:
        - Plant
      summary: ì‹ë¬¼ì˜ í˜„ì¬ ìƒíƒœ ì¡°íšŒ
      description: |
        ì‹ë¬¼ì˜ IDë¥¼ ì´ìš©í•´ í•´ë‹¹ ì‹ë¬¼ì˜ ì´ë¦„, ë ˆë²¨, ê²½í—˜ì¹˜, í˜¸ê°ë„ë¥¼ í¬í•¨í•œ ì¢…í•©ì ì¸ ìƒíƒœ ì •ë³´ë¥¼ ì¡°íšŒí•©ë‹ˆë‹¤.
        Access Tokenì—ì„œ userIdë¥¼ ìë™ìœ¼ë¡œ ì¶”ì¶œí•˜ì—¬ ì‚¬ìš©í•©ë‹ˆë‹¤.
      security:
        - BearerAuth: []
      parameters:
        - in: path
          name: plantId
          required: true
          schema:
            type: integer
          description: ì¡°íšŒí•  ì‹ë¬¼ì˜ ê³ ìœ  ID
          example: 1
      responses:
        '200':
          description: ì‹ë¬¼ ìƒíƒœ ì •ë³´ ì¡°íšŒ ì„±ê³µ
          content:
            application/json:
              schema:
                type: object
                properties:
                  code:
                    type: integer
                    example: 200
                  data:
                    type: object
                    properties:
                      plantName:
                        type: string
                        description: ì‹ë¬¼ ì´ë¦„ (ë‹‰ë„¤ì„)
                        example: "ê¸ˆìª½ì´"
                      level:
                        type: integer
                        description: ì‹ë¬¼ ë ˆë²¨
                        example: 5
                      experience:
                        type: integer
                        description: í˜„ì¬ ê²½í—˜ì¹˜
                        example: 120
                      likeability:
                        type: integer
                        description: í˜¸ê°ë„ (0-100)
                        example: 75
                  msg:
                    type: string
                    example: "Ok"
        '400':
          description: ì˜ëª»ëœ plantId
          content:
            application/json:
              schema:
                type: object
                properties:
                  code:
                    type: integer
                    example: 400
                  msg:
                    type: string
                    example: "Invalid plant ID"
        '401':
          description: ì¸ì¦ ì‹¤íŒ¨ (í† í° ì—†ìŒ ë˜ëŠ” ìœ íš¨í•˜ì§€ ì•ŠìŒ)
        '403':
          description: í•´ë‹¹ ì‹ë¬¼ì— ëŒ€í•œ ì ‘ê·¼ ê¶Œí•œ ì—†ìŒ
          content:
            application/json:
              schema:
                type: object
                properties:
                  code:
                    type: integer
                    example: 403
                  msg:
                    type: string
                    example: "Access denied"
        '404':
          description: í•´ë‹¹ ì‹ë¬¼ì„ ì°¾ì„ ìˆ˜ ì—†ìŒ
          content:
            application/json:
              schema:
                type: object
                properties:
                  code:
                    type: integer
                    example: 404
                  msg:
                    type: string
                    example: "Plant not found"
        '500':
          $ref: '#/components/responses/ServerError'

  /plant/state/{plantId}/experience:
    post:
      tags:
        - Plant
      summary: ì‹ë¬¼ ê²½í—˜ì¹˜ íšë“
      description: |
        ì‹ë¬¼ì—ê²Œ ê²½í—˜ì¹˜ë¥¼ ë¶€ì—¬í•˜ê³ , ìë™ìœ¼ë¡œ ë ˆë²¨ì—…ì„ ì²˜ë¦¬í•©ë‹ˆë‹¤.
        Access Tokenì—ì„œ userIdë¥¼ ìë™ìœ¼ë¡œ ì¶”ì¶œí•˜ì—¬ ì‚¬ìš©í•©ë‹ˆë‹¤.
      security:
        - BearerAuth: []
      parameters:
        - in: path
          name: plantId
          required: true
          schema:
            type: integer
          description: ê²½í—˜ì¹˜ë¥¼ ë¶€ì—¬í•  ì‹ë¬¼ì˜ ID
          example: 1
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - expGained
              properties:
                expGained:
                  type: number
                  description: íšë“í•  ê²½í—˜ì¹˜ ì–‘
                  example: 50
      responses:
        '200':
          description: ê²½í—˜ì¹˜ íšë“ ì„±ê³µ
          content:
            application/json:
              schema:
                type: object
                properties:
                  code:
                    type: integer
                    example: 200
                  data:
                    type: object
                    properties:
                      level:
                        type: integer
                        description: í˜„ì¬ ë ˆë²¨
                        example: 6
                      experience:
                        type: integer
                        description: í˜„ì¬ ê²½í—˜ì¹˜
                        example: 20
                      leveledUp:
                        type: boolean
                        description: ë ˆë²¨ì—… ì—¬ë¶€
                        example: true
                  msg:
                    type: string
                    example: "Ok"
        '400':
          description: ì˜ëª»ëœ ì…ë ¥ ë°ì´í„°
        '401':
          description: ì¸ì¦ ì‹¤íŒ¨ (í† í° ì—†ìŒ ë˜ëŠ” ìœ íš¨í•˜ì§€ ì•ŠìŒ)
        '403':
          description: í•´ë‹¹ ì‹ë¬¼ì— ëŒ€í•œ ì ‘ê·¼ ê¶Œí•œ ì—†ìŒ
          content:
            application/json:
              schema:
                type: object
                properties:
                  code:
                    type: integer
                    example: 403
                  msg:
                    type: string
                    example: "Access denied"
        '404':
          description: í•´ë‹¹ ì‹ë¬¼ì„ ì°¾ì„ ìˆ˜ ì—†ìŒ
          content:
            application/json:
              schema:
                type: object
                properties:
                  code:
                    type: integer
                    example: 404
                  msg:
                    type: string
                    example: "Plant not found"
        '500':
          $ref: '#/components/responses/ServerError'

  /plant/state/{plantId}/likeability:
    post:
      tags:
        - Plant
      summary: ì‹ë¬¼ í˜¸ê°ë„ ì¦ê°€
      description: |
        ì‹ë¬¼ì˜ í˜¸ê°ë„ë¥¼ ì¦ê°€ì‹œí‚µë‹ˆë‹¤. ìµœëŒ€ 100ê¹Œì§€ ì¦ê°€í•©ë‹ˆë‹¤.
        Access Tokenì—ì„œ userIdë¥¼ ìë™ìœ¼ë¡œ ì¶”ì¶œí•˜ì—¬ ì‚¬ìš©í•©ë‹ˆë‹¤.
      security:
        - BearerAuth: []
      parameters:
        - in: path
          name: plantId
          required: true
          schema:
            type: integer
          description: í˜¸ê°ë„ë¥¼ ì¦ê°€ì‹œí‚¬ ì‹ë¬¼ì˜ ID
          example: 1
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - amount
              properties:
                amount:
                  type: number
                  description: ì¦ê°€ì‹œí‚¬ í˜¸ê°ë„ ì–‘
                  example: 10
      responses:
        '200':
          description: í˜¸ê°ë„ ì¦ê°€ ì„±ê³µ
          content:
            application/json:
              schema:
                type: object
                properties:
                  code:
                    type: integer
                    example: 200
                  data:
                    type: object
                    properties:
                      likeability:
                        type: integer
                        description: í˜„ì¬ í˜¸ê°ë„
                        example: 85
                  msg:
                    type: string
                    example: "Ok"
        '400':
          description: ì˜ëª»ëœ ì…ë ¥ ë°ì´í„°
        '401':
          description: ì¸ì¦ ì‹¤íŒ¨ (í† í° ì—†ìŒ ë˜ëŠ” ìœ íš¨í•˜ì§€ ì•ŠìŒ)
        '403':
          description: í•´ë‹¹ ì‹ë¬¼ì— ëŒ€í•œ ì ‘ê·¼ ê¶Œí•œ ì—†ìŒ
          content:
            application/json:
              schema:
                type: object
                properties:
                  code:
                    type: integer
                    example: 403
                  msg:
                    type: string
                    example: "Access denied"
        '404':
          description: í•´ë‹¹ ì‹ë¬¼ì„ ì°¾ì„ ìˆ˜ ì—†ìŒ
          content:
            application/json:
              schema:
                type: object
                properties:
                  code:
                    type: integer
                    example: 404
                  msg:
                    type: string
                    example: "Plant not found"
        '500':
          $ref: '#/components/responses/ServerError'

  # -------------------- Chat APIs --------------------
  /chat/plant:
    post:
      tags:
        - Chat
      summary: ì‹ë¬¼ ì±—ë´‡ê³¼ ëŒ€í™”í•˜ê¸°
      description: |
        ì‚¬ìš©ìê°€ ì‹ë¬¼ì—ê²Œ ë©”ì‹œì§€ë¥¼ ë³´ë‚´ê³ , ì±—ë´‡ì˜ ì‘ë‹µì„ ë°›ìŠµë‹ˆë‹¤. ì´ì „ ëŒ€í™” ê¸°ë¡ì„ ë°”íƒ•ìœ¼ë¡œ ë‹µë³€ì´ ìƒì„±ë˜ë©°, ëª¨ë“  ëŒ€í™”ëŠ” DBì— ê¸°ë¡ë©ë‹ˆë‹¤.
        Access Tokenì—ì„œ userIdë¥¼ ìë™ìœ¼ë¡œ ì¶”ì¶œí•˜ì—¬ ì‚¬ìš©í•©ë‹ˆë‹¤.
      security:
        - BearerAuth: []
      requestBody:
        description: ì±—ë´‡ì—ê²Œ ë³´ë‚¼ ë©”ì‹œì§€ì™€ ì‹ë¬¼ ì •ë³´ (userIdëŠ” í† í°ì—ì„œ ìë™ ì¶”ì¶œ)
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - plantId
                - message
              properties:
                plantId:
                  type: integer
                  description: "ëŒ€í™”í•  ì‹ë¬¼ ID"
                  example: 1
                message:
                  type: string
                  description: "ì‚¬ìš©ìê°€ ì…ë ¥í•œ ë©”ì‹œì§€"
                  example: "ì˜¤ëŠ˜ í•˜ë£¨ ì–´ë• ì–´?"
                emotion:
                  type: string
                  description: "(ì„ íƒ) ì‚¬ìš©ìì˜ í˜„ì¬ ê°ì • ìƒíƒœ. ì±—ë´‡ ë‹µë³€ì— ì˜í–¥ì„ ì¤„ ìˆ˜ ìˆìŠµë‹ˆë‹¤."
                  nullable: true
                  example: "í–‰ë³µ"
      responses:
        '200':
          description: ì±—ë´‡ì˜ ì‘ë‹µ ì„±ê³µ
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ChatResponse'
        '401':
          description: ì¸ì¦ ì‹¤íŒ¨ (í† í° ì—†ìŒ ë˜ëŠ” ìœ íš¨í•˜ì§€ ì•ŠìŒ)
        '404':
          description: ìš”ì²­ì— í¬í•¨ëœ ì‚¬ìš©ìë‚˜ ì‹ë¬¼ì„ ì°¾ì„ ìˆ˜ ì—†ëŠ” ê²½ìš°
        '500':
          $ref: '#/components/responses/ServerError'

  /chat/history/{plantId}:
    get:
      tags:
        - Chat
      summary: íŠ¹ì • ì‹ë¬¼ê³¼ì˜ ì±„íŒ… ê¸°ë¡ ì¡°íšŒ
      description: |
        ì¸ì¦ëœ ì‚¬ìš©ìì™€ íŠ¹ì • ì‹ë¬¼ ê°„ì˜ ì „ì²´ ëŒ€í™” ê¸°ë¡ì„ ì‹œê°„ ìˆœìœ¼ë¡œ ì¡°íšŒí•©ë‹ˆë‹¤.
        Access Tokenì—ì„œ userIdë¥¼ ìë™ìœ¼ë¡œ ì¶”ì¶œí•˜ì—¬ ì‚¬ìš©í•©ë‹ˆë‹¤.
      security:
        - BearerAuth: []
      parameters:
        - in: path
          name: plantId
          required: true
          schema:
            type: integer
          description: ëŒ€í™” ê¸°ë¡ì„ ì¡°íšŒí•  ì‹ë¬¼ ID
          example: 1
      responses:
        '200':
          description: ì±„íŒ… ê¸°ë¡ ì¡°íšŒ ì„±ê³µ
          content:
            application/json:
              schema:
                type: object
                properties:
                  code:
                    type: integer
                    example: 200
                  data:
                    type: array
                    items:
                      $ref: '#/components/schemas/ChatHistory'
                    description: "ëŒ€í™” ê¸°ë¡ ë°°ì—´ (ì‹œê°„ ìˆœ ì •ë ¬)"
                  msg:
                    type: string
                    example: "Ok"
              example:
                code: 200
                data:
                  - userId: 1
                    plantId: 1
                    message: "ì˜¤ëŠ˜ í•˜ë£¨ ì–´ë• ì–´?"
                    sendDate: "2025-10-15T09:00:00.000Z"
                    userType: "User"
                  - userId: 1
                    plantId: 1
                    message: "ì •ë§ ì¦ê±°ìš´ í•˜ë£¨ì˜€ì–´ìš”!"
                    sendDate: "2025-10-15T09:00:05.000Z"
                    userType: "Bot"
                msg: "Ok"
        '400':
          description: ì˜ëª»ëœ plantId (ìœ íš¨í•˜ì§€ ì•Šì€ í˜•ì‹ ë˜ëŠ” ìŒìˆ˜)
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
              example:
                code: 400
                msg: "Invalid plant ID"
        '401':
          description: ì¸ì¦ ì‹¤íŒ¨ (í† í° ì—†ìŒ ë˜ëŠ” ìœ íš¨í•˜ì§€ ì•ŠìŒ)
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
              example:
                code: 401
                msg: "Unauthorized"
        '404':
          description: ì‹ë¬¼ì„ ì°¾ì„ ìˆ˜ ì—†ìŒ
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
              example:
                code: 404
                msg: "Plant not found"
        '500':
          $ref: '#/components/responses/ServerError'


  # ==================== Diary APIs ====================
  /diaries/create:
    post:
      tags:
        - Diary
      summary: ì„±ì¥ ì¼ê¸° ìƒì„± (ì±—ë´‡ ê¸°ë°˜)
      description: |
        ì¼ê¸° ë¦¬ì†ŒìŠ¤ë¥¼ ìƒì„±í•©ë‹ˆë‹¤. ì‚¬ìš©ìì™€ ì±—ë´‡ì˜ í•˜ë£¨ ëŒ€í™” ê¸°ë¡ì„ ë°”íƒ•ìœ¼ë¡œ ìƒˆë¡œìš´ ì„±ì¥ ì¼ê¸°ë¥¼ ìƒì„±í•˜ë©°, ê°™ì€ ë‚ ì§œì— ë‹¤ì‹œ ìš”ì²­í•˜ë©´ ê¸°ì¡´ ì¼ê¸°ë¥¼ ì—…ë°ì´íŠ¸í•©ë‹ˆë‹¤.
        Access Tokenì—ì„œ userIdë¥¼ ìë™ìœ¼ë¡œ ì¶”ì¶œí•˜ì—¬ ì‚¬ìš©í•©ë‹ˆë‹¤.
      security:
        - BearerAuth: []
      requestBody:
        description: ì¼ê¸° ìƒì„±ì„ ìœ„í•œ ì‹ë¬¼ ì •ë³´ ë° íŠ¸ë¦¬ê±° ë©”ì‹œì§€ (userIdëŠ” í† í°ì—ì„œ ìë™ ì¶”ì¶œ)
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [plantId, message]
              properties:
                plantId:
                  type: integer
                  example: 1
                message:
                  type: string
                  example: "ì˜¤ëŠ˜ í•˜ë£¨ë¥¼ ì¼ê¸°ë¡œ ë§Œë“¤ì–´ì¤˜."
      responses:
        '200':
          description: ì¼ê¸° ìƒì„± ë˜ëŠ” ì—…ë°ì´íŠ¸ ì„±ê³µ. ìƒì„±/ì—…ë°ì´íŠ¸ëœ ì¼ê¸° ë°ì´í„°ë¥¼ ë°˜í™˜í•©ë‹ˆë‹¤.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/DiaryResponse'
        '401':
          description: ì¸ì¦ ì‹¤íŒ¨ (í† í° ì—†ìŒ ë˜ëŠ” ìœ íš¨í•˜ì§€ ì•ŠìŒ)
        '500':
          $ref: '#/components/responses/ServerError'

  /diaries/month/{yearMonth}:
    get:
      tags:
        - Diary
      summary: ì›”ë³„ ì¼ê¸° ëª©ë¡ ì¡°íšŒ
      description: |
        ì¸ì¦ëœ ì‚¬ìš©ìê°€ íŠ¹ì • ì›”ì— ì‘ì„±í•œ ì¼ê¸° ëª©ë¡ì„ ì¡°íšŒí•©ë‹ˆë‹¤.
        ê° ì¼ê¸°ì˜ ID, ë‚ ì§œ, ì œëª©, ë¯¸ë¦¬ë³´ê¸°, ìˆ˜ì • ì—¬ë¶€, ìƒì„± ì‹œê°„ ë“±ì„ í¬í•¨í•©ë‹ˆë‹¤.
        Access Tokenì—ì„œ userIdë¥¼ ìë™ìœ¼ë¡œ ì¶”ì¶œí•˜ì—¬ ì‚¬ìš©í•©ë‹ˆë‹¤.
      security:
        - BearerAuth: []
      parameters:
        - in: path
          name: yearMonth
          required: true
          schema:
            type: string
          description: "ì¡°íšŒí•  ì—°ì›” (YYYY-MM í˜•ì‹)"
          example: "2025-10"
      responses:
        '200':
          description: ì¼ê¸° ëª©ë¡ ì¡°íšŒ ì„±ê³µ
          content:
            application/json:
              schema:
                type: object
                properties:
                  code:
                    type: integer
                    example: 200
                  data:
                    type: object
                    properties:
                      diaries:
                        type: array
                        description: "ì¼ê¸° ëª©ë¡ ë°°ì—´ (ë‚ ì§œ ì˜¤ë¦„ì°¨ìˆœ ì •ë ¬)"
                        items:
                          type: object
                          properties:
                            diaryId:
                              type: integer
                              description: "ì¼ê¸° ê³ ìœ  ID (ëŒ“ê¸€, ìˆ˜ì •, ì‚­ì œ ì‹œ í•„ìš”)"
                              example: 10
                            date:
                              type: string
                              format: date
                              description: "ì¼ê¸° ì‘ì„± ë‚ ì§œ (YYYY-MM-DD)"
                              example: "2025-10-10"
                            title:
                              type: string
                              description: "ì¼ê¸° ì œëª©"
                              example: "2025-10-10 ì¼ì§€"
                            contentPreview:
                              type: string
                              description: "ì¼ê¸° ë‚´ìš© ë¯¸ë¦¬ë³´ê¸° (ìµœëŒ€ 100ì, ì´ˆê³¼ ì‹œ '...' ì¶”ê°€)"
                              example: "ì˜¤ëŠ˜ì€ ì¡°ê¸ˆ í˜ë“  í•˜ë£¨ì˜€ì§€ë§Œ, ê¸ˆìª½ì´ì™€ ëŒ€í™”í•˜ë©´ì„œ ìœ„ë¡œë°›ì•˜ë‹¤..."
                            edited:
                              type: boolean
                              description: "ì¼ê¸° ìˆ˜ì • ì—¬ë¶€"
                              example: true
                            createdAt:
                              type: string
                              format: date-time
                              description: "ì¼ê¸° ìƒì„± ì‹œê°„"
                              example: "2025-10-10T20:15:00.000Z"
                  msg:
                    type: string
                    example: "Ok"
              example:
                code: 200
                data:
                  diaries:
                    - diaryId: 10
                      date: "2025-10-10"
                      title: "2025-10-10 ì¼ì§€"
                      contentPreview: "ì˜¤ëŠ˜ì€ ì¡°ê¸ˆ í˜ë“  í•˜ë£¨ì˜€ì§€ë§Œ, ê¸ˆìª½ì´ì™€ ëŒ€í™”í•˜ë©´ì„œ ìœ„ë¡œë°›ì•˜ë‹¤..."
                      edited: true
                      createdAt: "2025-10-10T20:15:00.000Z"
                    - diaryId: 15
                      date: "2025-10-15"
                      title: "2025-10-15 ì¼ì§€"
                      contentPreview: "ì˜¤ëŠ˜ì€ ì •ë§ ì¢‹ì€ í•˜ë£¨ì˜€ë‹¤. ì•„ì¹¨ì— ì¼ì–´ë‚˜ì„œ ì‹ë¬¼ì´ ìë¼ëŠ” ëª¨ìŠµì„ ë³´ë‹ˆ ê¸°ë¶„ì´ ì¢‹ì•˜ë‹¤..."
                      edited: false
                      createdAt: "2025-10-15T09:30:00.000Z"
                msg: "Ok"
        '400':
          description: ì˜ëª»ëœ yearMonth í˜•ì‹
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
              example:
                code: 400
                msg: "Invalid or missing parameters"
        '401':
          description: ì¸ì¦ ì‹¤íŒ¨ (í† í° ì—†ìŒ ë˜ëŠ” ìœ íš¨í•˜ì§€ ì•ŠìŒ)
        '500':
          $ref: '#/components/responses/ServerError'

  /diaries/{diaryId}:
    get:
      tags:
        - Diary
      summary: ì¼ê¸° ìƒì„¸ ì¡°íšŒ
      description: |
        ì¼ê¸° IDë¡œ íŠ¹ì • ì¼ê¸° ë¦¬ì†ŒìŠ¤ë¥¼ ì¡°íšŒí•©ë‹ˆë‹¤.
        Access Tokenì—ì„œ userIdë¥¼ ìë™ìœ¼ë¡œ ì¶”ì¶œí•˜ì—¬ ê¶Œí•œì„ í™•ì¸í•©ë‹ˆë‹¤.
      security:
        - BearerAuth: []
      parameters:
        - in: path
          name: diaryId
          required: true
          schema:
            type: integer
          description: "ì¡°íšŒí•  ì¼ê¸°ì˜ ID"
          example: 15
      responses:
        '200':
          description: ì¼ê¸° ì¡°íšŒ ì„±ê³µ
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/DiaryResponse'
        '400':
          description: ì˜ëª»ëœ ì¼ê¸° ID
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
              example:
                code: 400
                msg: "Invalid diary ID"
        '401':
          description: ì¸ì¦ ì‹¤íŒ¨ (í† í° ì—†ìŒ ë˜ëŠ” ìœ íš¨í•˜ì§€ ì•ŠìŒ)
        '404':
          description: ì¼ê¸°ë¥¼ ì°¾ì„ ìˆ˜ ì—†ê±°ë‚˜ ì ‘ê·¼ ê¶Œí•œì´ ì—†ìŒ
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
              example:
                code: 404
                msg: "Diary not found"
        '500':
          $ref: '#/components/responses/ServerError'

  /diaries/date/{date}:
    get:
      tags:
        - Diary
      summary: íŠ¹ì • ë‚ ì§œì˜ ì¼ê¸° ì¡°íšŒ
      description: |
        ì¸ì¦ëœ ì‚¬ìš©ìê°€ ì§€ì •ëœ ë‚ ì§œ(YYYY-MM-DD)ì— ì‘ì„±í•œ ì¼ê¸° ë¦¬ì†ŒìŠ¤ë¥¼ ì¡°íšŒí•©ë‹ˆë‹¤.
        Access Tokenì—ì„œ userIdë¥¼ ìë™ìœ¼ë¡œ ì¶”ì¶œí•˜ì—¬ ì‚¬ìš©í•©ë‹ˆë‹¤.
      security:
        - BearerAuth: []
      parameters:
        - in: path
          name: date
          required: true
          schema:
            type: string
            format: date
          description: "ì¡°íšŒí•  ë‚ ì§œ (YYYY-MM-DD í˜•ì‹)"
          example: "2025-10-01"
      responses:
        '200':
          description: ì¼ê¸° ì¡°íšŒ ì„±ê³µ
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/DiaryResponse'
        '401':
          description: ì¸ì¦ ì‹¤íŒ¨ (í† í° ì—†ìŒ ë˜ëŠ” ìœ íš¨í•˜ì§€ ì•ŠìŒ)
        '404':
          description: í•´ë‹¹ ë‚ ì§œì— ì‘ì„±ëœ ì¼ê¸°ê°€ ì—†ìŒ
        '500':
          $ref: '#/components/responses/ServerError'

  # ==================== Comment APIs (Diaryì˜ í•˜ìœ„ ë¦¬ì†ŒìŠ¤) ====================
  /diaries/{diaryId}/comments:
    get:
      tags:
        - Diary
      summary: íŠ¹ì • ì¼ê¸°ì˜ ëŒ“ê¸€ ëª©ë¡ ì¡°íšŒ
      description: |
        íŠ¹ì • ì¼ê¸°ì— ì†í•œ ëŒ“ê¸€ ë¦¬ì†ŒìŠ¤ ì»¬ë ‰ì…˜ì„ ì¡°íšŒí•©ë‹ˆë‹¤.
        CommentëŠ” Diaryì˜ í•˜ìœ„ ë¦¬ì†ŒìŠ¤ì…ë‹ˆë‹¤.
        Access Tokenì—ì„œ userIdë¥¼ ìë™ìœ¼ë¡œ ì¶”ì¶œí•˜ì—¬ ì‚¬ìš©í•©ë‹ˆë‹¤.
      security:
        - BearerAuth: []
      parameters:
        - in: path
          name: diaryId
          required: true
          schema:
            type: integer
          description: "ëŒ“ê¸€ì„ ì¡°íšŒí•  ì¼ê¸°ì˜ ID"
          example: 10
      responses:
        '200':
          description: ëŒ“ê¸€ ëª©ë¡ ì¡°íšŒ ì„±ê³µ. ëŒ“ê¸€ ê°ì²´ì˜ ë°°ì—´ì„ ë°˜í™˜í•©ë‹ˆë‹¤.
          content:
            application/json:
              schema:
                type: object
                properties:
                  code:
                    type: integer
                    example: 200
                  data:
                    type: array
                    items:
                      $ref: '#/components/schemas/GrowthDiaryComment'
                  msg:
                    type: string
                    example: "Ok"
        '401':
          description: ì¸ì¦ ì‹¤íŒ¨ (í† í° ì—†ìŒ ë˜ëŠ” ìœ íš¨í•˜ì§€ ì•ŠìŒ)
        '500':
          $ref: '#/components/responses/ServerError'

    post:
      tags:
        - Diary
      summary: ëŒ“ê¸€ ìƒì„±
      description: |
        íŠ¹ì • ì¼ê¸°ì— ìƒˆë¡œìš´ ëŒ“ê¸€ ë¦¬ì†ŒìŠ¤ë¥¼ ìƒì„±í•©ë‹ˆë‹¤.
        CommentëŠ” Diaryì˜ í•˜ìœ„ ë¦¬ì†ŒìŠ¤ì…ë‹ˆë‹¤.
        Access Tokenì—ì„œ userIdë¥¼ ìë™ìœ¼ë¡œ ì¶”ì¶œí•˜ì—¬ ì‚¬ìš©í•©ë‹ˆë‹¤.
      security:
        - BearerAuth: []
      parameters:
        - in: path
          name: diaryId
          required: true
          schema:
            type: integer
          description: "ëŒ“ê¸€ì´ ë‹¬ë¦´ ì¼ê¸°ì˜ ID"
          example: 10
      requestBody:
        description: ëŒ“ê¸€ ë‚´ìš© (userIdì™€ diaryIdëŠ” í† í° ë° URLì—ì„œ ìë™ ì¶”ì¶œ)
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [content]
              properties:
                content:
                  type: string
                  description: "ëŒ“ê¸€ ë‚´ìš©"
                  example: "ì¢‹ì€ ê¸€ì´ë„¤ìš”!"
      responses:
        '200':
          description: ëŒ“ê¸€ ì‘ì„± ì„±ê³µ. ìƒì„±ëœ ëŒ“ê¸€ ê°ì²´ë¥¼ ë°˜í™˜í•©ë‹ˆë‹¤.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CommentResponse'
        '401':
          description: ì¸ì¦ ì‹¤íŒ¨ (í† í° ì—†ìŒ ë˜ëŠ” ìœ íš¨í•˜ì§€ ì•ŠìŒ)
        '500':
          $ref: '#/components/responses/ServerError'

  /diaries/{diaryId}/comments/{commentId}:
    put:
      tags:
        - Diary
      summary: ëŒ“ê¸€ ìˆ˜ì •
      description: |
        íŠ¹ì • ëŒ“ê¸€ ë¦¬ì†ŒìŠ¤ì˜ ë‚´ìš©ì„ ìˆ˜ì •í•©ë‹ˆë‹¤.
        CommentëŠ” Diaryì˜ í•˜ìœ„ ë¦¬ì†ŒìŠ¤ì…ë‹ˆë‹¤.
        Access Tokenì—ì„œ userIdë¥¼ ìë™ìœ¼ë¡œ ì¶”ì¶œí•˜ì—¬ ì‚¬ìš©í•©ë‹ˆë‹¤.
      security:
        - BearerAuth: []
      parameters:
        - in: path
          name: diaryId
          required: true
          schema:
            type: integer
          description: "ëŒ“ê¸€ì´ ì†í•œ ì¼ê¸°ì˜ ID"
          example: 10
        - in: path
          name: commentId
          required: true
          schema:
            type: integer
          description: "ìˆ˜ì •í•  ëŒ“ê¸€ì˜ ID"
          example: 25
      requestBody:
        description: ìˆ˜ì •í•  ëŒ“ê¸€ì˜ ë‚´ìš© (userId, diaryId, commentIdëŠ” í† í° ë° URLì—ì„œ ìë™ ì¶”ì¶œ)
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [content]
              properties:
                content:
                  type: string
                  description: "ìˆ˜ì •í•  ëŒ“ê¸€ ë‚´ìš©"
                  example: "ìˆ˜ì •ëœ ëŒ“ê¸€ ë‚´ìš©ì…ë‹ˆë‹¤!"
      responses:
        '200':
          description: ëŒ“ê¸€ ìˆ˜ì • ì„±ê³µ. ìˆ˜ì •ëœ ëŒ“ê¸€ ê°ì²´ë¥¼ ë°˜í™˜í•©ë‹ˆë‹¤.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CommentResponse'
        '401':
          description: ì¸ì¦ ì‹¤íŒ¨ (í† í° ì—†ìŒ ë˜ëŠ” ìœ íš¨í•˜ì§€ ì•ŠìŒ)
        '500':
          $ref: '#/components/responses/ServerError'

    delete:
      tags:
        - Diary
      summary: ëŒ“ê¸€ ì‚­ì œ
      description: |
        íŠ¹ì • ëŒ“ê¸€ ë¦¬ì†ŒìŠ¤ë¥¼ ì‚­ì œí•©ë‹ˆë‹¤.
        CommentëŠ” Diaryì˜ í•˜ìœ„ ë¦¬ì†ŒìŠ¤ì…ë‹ˆë‹¤.
        Access Tokenì—ì„œ userIdë¥¼ ìë™ìœ¼ë¡œ ì¶”ì¶œí•˜ì—¬ ì‚¬ìš©í•©ë‹ˆë‹¤.
      security:
        - BearerAuth: []
      parameters:
        - in: path
          name: diaryId
          required: true
          schema:
            type: integer
          description: "ëŒ“ê¸€ì´ ì†í•œ ì¼ê¸°ì˜ ID"
          example: 10
        - in: path
          name: commentId
          required: true
          schema:
            type: integer
          description: "ì‚­ì œí•  ëŒ“ê¸€ì˜ ID"
          example: 25
      responses:
        '200':
          description: ëŒ“ê¸€ ì‚­ì œ ì„±ê³µ. ë³„ë„ì˜ ë°ì´í„° ì—†ì´ ì„±ê³µ ë©”ì‹œì§€ë§Œ ë°˜í™˜í•©ë‹ˆë‹¤.
          content:
            application/json:
              schema:
                type: object
                properties:
                  code: { type: integer, example: 200 }
                  msg: { type: string, example: "Ok" }
        '401':
          description: ì¸ì¦ ì‹¤íŒ¨ (í† í° ì—†ìŒ ë˜ëŠ” ìœ íš¨í•˜ì§€ ì•ŠìŒ)
        '500':
          $ref: '#/components/responses/ServerError'


  # ==================== Friend APIs ====================
  /friends:
    get:
      tags:
        - Friend
      summary: ì¹œêµ¬ ëª©ë¡ ì¡°íšŒ
      description: |
        ì¸ì¦ëœ ì‚¬ìš©ìì˜ ì¹œêµ¬ ëª©ë¡ì„ ì¡°íšŒí•©ë‹ˆë‹¤.
        Access Tokenì—ì„œ userIdë¥¼ ìë™ìœ¼ë¡œ ì¶”ì¶œí•˜ì—¬ ì‚¬ìš©í•©ë‹ˆë‹¤.
      security:
        - BearerAuth: []
      responses:
        '200':
          description: ì¹œêµ¬ ëª©ë¡ ì¡°íšŒ ì„±ê³µ
          content:
            application/json:
              schema:
                type: object
                properties:
                  code:
                    type: integer
                    example: 200
                  data:
                    $ref: '#/components/schemas/FriendList'
                  msg:
                    type: string
                    example: "Ok"
        '401':
          description: ì¸ì¦ ì‹¤íŒ¨ (í† í° ì—†ìŒ ë˜ëŠ” ìœ íš¨í•˜ì§€ ì•ŠìŒ)
        '500':
          $ref: '#/components/responses/ServerError'

  /friends/{friendId}:
    delete:
      tags:
        - Friend
      summary: ì¹œêµ¬ ì‚­ì œ
      description: |
        í˜„ì¬ ì¹œêµ¬ ê´€ê³„ë¥¼ í•´ì œí•©ë‹ˆë‹¤.
      security:
        - BearerAuth: []
      parameters:
        - in: path
          name: friendId
          required: true
          schema:
            type: integer
          description: "ì‚­ì œí•  ì¹œêµ¬ì˜ ì‚¬ìš©ì ID"
          example: 31
      responses:
        '200':
          description: ì¹œêµ¬ ì‚­ì œ ì„±ê³µ
          content:
            application/json:
              schema:
                type: object
                properties:
                  code:
                    type: integer
                    example: 200
                  msg:
                    type: string
                    example: "ì¹œêµ¬ ì‚­ì œ ì™„ë£Œ"
        '401':
          description: ì¸ì¦ ì‹¤íŒ¨
        '404':
          description: ì¹œêµ¬ ê´€ê³„ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŒ
        '500':
          $ref: '#/components/responses/ServerError'

  /friends/recommend:
    get:
      tags:
        - Friend
      summary: ë°˜ëŒ€ ì„±í–¥ ì¹œêµ¬ ì¶”ì²œ
      description: |
        ìµœê·¼ í™œë™ ê¸°ë°˜ìœ¼ë¡œ ì‚¬ìš©ìì™€ ì„±í–¥ì´ ëŒ€ë¹„ë˜ëŠ” ì¹œêµ¬ í›„ë³´ë¥¼ ì¶”ì²œí•©ë‹ˆë‹¤.
        Access Tokenì—ì„œ userIdë¥¼ ì¶”ì¶œí•˜ì—¬ ì‚¬ìš©í•©ë‹ˆë‹¤.
      security:
        - BearerAuth: []
      parameters:
        - in: query
          name: n
          required: false
          schema:
            type: integer
            minimum: 1
          description: "ê°€ì ¸ì˜¬ ì¶”ì²œ ìˆ˜ (ê¸°ë³¸ 10)"
          example: 10
      responses:
        '200':
          description: ì¹œêµ¬ ì¶”ì²œ ì„±ê³µ
          content:
            application/json:
              schema:
                type: object
                properties:
                  code:
                    type: integer
                    example: 200
                  msg:
                    type: string
                    example: "Ok"
                  data:
                    $ref: '#/components/schemas/FriendRecommendationResult'
        '401':
          description: ì¸ì¦ ì‹¤íŒ¨ (í† í° ì—†ìŒ ë˜ëŠ” ìœ íš¨í•˜ì§€ ì•ŠìŒ)
        '500':
          $ref: '#/components/responses/ServerError'

  /friends/requests/inbound:
    get:
      tags:
        - Friend
      summary: ë°›ì€ ì¹œêµ¬ ìš”ì²­ ëª©ë¡
      description: |
        ë‚˜ì—ê²Œ ë“¤ì–´ì˜¨ ì¹œêµ¬ ìš”ì²­(ëŒ€ê¸°ì¤‘)ì„ ì¡°íšŒí•©ë‹ˆë‹¤.
      security:
        - BearerAuth: []
      responses:
        '200':
          description: ë°›ì€ ìš”ì²­ ëª©ë¡ ì¡°íšŒ ì„±ê³µ
          content:
            application/json:
              schema:
                type: object
                properties:
                  code:
                    type: integer
                    example: 200
                  data:
                    $ref: '#/components/schemas/FriendRequestList'
                  msg:
                    type: string
                    example: "Ok"
        '401':
          description: ì¸ì¦ ì‹¤íŒ¨
        '500':
          $ref: '#/components/responses/ServerError'

  /friends/requests/outbound:
    get:
      tags:
        - Friend
      summary: ë³´ë‚¸ ì¹œêµ¬ ìš”ì²­ ëª©ë¡
      description: |
        ë‚´ê°€ ë³´ë‚¸ ì¹œêµ¬ ìš”ì²­(ëŒ€ê¸°ì¤‘)ì„ ì¡°íšŒí•©ë‹ˆë‹¤.
      security:
        - BearerAuth: []
      responses:
        '200':
          description: ë³´ë‚¸ ìš”ì²­ ëª©ë¡ ì¡°íšŒ ì„±ê³µ
          content:
            application/json:
              schema:
                type: object
                properties:
                  code:
                    type: integer
                    example: 200
                  data:
                    $ref: '#/components/schemas/FriendRequestList'
                  msg:
                    type: string
                    example: "Ok"
        '401':
          description: ì¸ì¦ ì‹¤íŒ¨
        '500':
          $ref: '#/components/responses/ServerError'

  /friends/requests:
    post:
      tags:
        - Friend
      summary: ì¹œêµ¬ ìš”ì²­ ìƒì„±
      description: |
        ìƒˆë¡œìš´ ì¹œêµ¬ ìš”ì²­ì„ ìƒì„±í•©ë‹ˆë‹¤.
        ìš”ì²­ì„ ë³´ë‚´ëŠ” ì‚¬ìš©ìëŠ” Access Tokenì—ì„œ ìë™ìœ¼ë¡œ ì¶”ì¶œë©ë‹ˆë‹¤.
      security:
        - BearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [targetUserId]
              properties:
                targetUserId:
                  type: integer
                  description: "ì¹œêµ¬ ìš”ì²­ì„ ë°›ì„ ì‚¬ìš©ì ID"
                  example: 47
      responses:
        '200':
          description: ì¹œêµ¬ ìš”ì²­ ìƒì„± ì„±ê³µ
        '400':
          description: ìê¸° ìì‹ ì—ê²Œ ìš”ì²­, ì´ë¯¸ ì¹œêµ¬ì´ê±°ë‚˜ ìš”ì²­ ëŒ€ê¸°ì¤‘ì¸ ê²½ìš°
        '401':
          description: ì¸ì¦ ì‹¤íŒ¨
        '404':
          description: ìš”ì²­ì„ ë°›ëŠ” ì‚¬ìš©ìë¥¼ ì°¾ì„ ìˆ˜ ì—†ëŠ” ê²½ìš°
        '500':
          $ref: '#/components/responses/ServerError'

  /friends/requests/{requestId}/accept:
    post:
      tags:
        - Friend
      summary: ì¹œêµ¬ ìš”ì²­ ìˆ˜ë½
      description: |
        ì¹œêµ¬ ìš”ì²­ì„ ìˆ˜ë½í•©ë‹ˆë‹¤.
        ìš”ì²­ì„ ë°›ì€ ì‚¬ìš©ìë§Œ í˜¸ì¶œí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
      security:
        - BearerAuth: []
      parameters:
        - in: path
          name: requestId
          required: true
          schema:
            type: integer
          description: "ìˆ˜ë½í•  ì¹œêµ¬ ìš”ì²­ ID"
          example: 89
      responses:
        '200':
          description: ì¹œêµ¬ ìš”ì²­ ìˆ˜ë½ ì„±ê³µ
        '400':
          description: í•´ë‹¹ ì¹œêµ¬ ìš”ì²­ì´ ì¡´ì¬í•˜ì§€ ì•Šê±°ë‚˜ ì´ë¯¸ ì²˜ë¦¬ëœ ê²½ìš°
        '401':
          description: ì¸ì¦ ì‹¤íŒ¨
        '403':
          description: ê¶Œí•œ ì—†ìŒ
        '500':
          $ref: '#/components/responses/ServerError'

  /friends/requests/{requestId}/reject:
    post:
      tags:
        - Friend
      summary: ì¹œêµ¬ ìš”ì²­ ê±°ì ˆ
      description: |
        ì¹œêµ¬ ìš”ì²­ì„ ê±°ì ˆí•©ë‹ˆë‹¤.
        ìš”ì²­ì„ ë°›ì€ ì‚¬ìš©ìë§Œ í˜¸ì¶œí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
      security:
        - BearerAuth: []
      parameters:
        - in: path
          name: requestId
          required: true
          schema:
            type: integer
          description: "ê±°ì ˆí•  ì¹œêµ¬ ìš”ì²­ ID"
          example: 89
      responses:
        '200':
          description: ì¹œêµ¬ ìš”ì²­ ê±°ì ˆ ì„±ê³µ
        '400':
          description: í•´ë‹¹ ì¹œêµ¬ ìš”ì²­ì´ ì¡´ì¬í•˜ì§€ ì•Šê±°ë‚˜ ì´ë¯¸ ì²˜ë¦¬ëœ ê²½ìš°
        '401':
          description: ì¸ì¦ ì‹¤íŒ¨
        '403':
          description: ê¶Œí•œ ì—†ìŒ
        '500':
          $ref: '#/components/responses/ServerError'

  /friends/requests/{requestId}:
    delete:
      tags:
        - Friend
      summary: ì¹œêµ¬ ìš”ì²­ ì·¨ì†Œ
      description: |
        ë‚´ê°€ ë³´ë‚¸ ì¹œêµ¬ ìš”ì²­ì„ ì·¨ì†Œí•©ë‹ˆë‹¤.
      security:
        - BearerAuth: []
      parameters:
        - in: path
          name: requestId
          required: true
          schema:
            type: integer
          description: "ì·¨ì†Œí•  ì¹œêµ¬ ìš”ì²­ ID"
          example: 102
      requestBody:
      responses:
        '200':
          description: ì¹œêµ¬ ìš”ì²­ ì·¨ì†Œ ì„±ê³µ
        '400':
          description: í•´ë‹¹ ì¹œêµ¬ ìš”ì²­ì´ ì¡´ì¬í•˜ì§€ ì•Šê±°ë‚˜ ì´ë¯¸ ì²˜ë¦¬ëœ ê²½ìš°
        '401':
          description: ì¸ì¦ ì‹¤íŒ¨
        '403':
          description: ê¶Œí•œ ì—†ìŒ
        '500':
          $ref: '#/components/responses/ServerError'

  # -------------------- Mission APIs --------------------
  /missions/recommend:
    get:
      tags:
        - Mission
      summary: ì˜¤ëŠ˜ ë¯¸ì…˜ ì¶”ì²œ ë° ë°°ì •
      description: |
        ì˜¤ëŠ˜ ë‚ ì§œì— ë¯¸ì…˜ì´ ì—†ë‹¤ë©´ ê¸°ë³¸ ë¯¸ì…˜ì„ ìë™ ë°°ì •í•˜ê³ , ì¡´ì¬í•œë‹¤ë©´ í˜„ì¬ ëª©ë¡ì„ ê·¸ëŒ€ë¡œ ë°˜í™˜í•©ë‹ˆë‹¤.
        ì¶”ì²œ ê°œìˆ˜ëŠ” `n` íŒŒë¼ë¯¸í„°(ìµœëŒ€ 3ê°œ)ë¡œ ì¡°ì ˆí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
      security:
        - BearerAuth: []
      parameters:
        - in: query
          name: n
          required: false
          description: ì¶”ì²œ ë¯¸ì…˜ ê°œìˆ˜ (ê¸°ë³¸ê°’ 2, ìµœëŒ€ 3)
          schema:
            type: integer
            minimum: 1
            maximum: 3
      responses:
        '200':
          description: ì˜¤ëŠ˜ ë¯¸ì…˜ ëª©ë¡
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/MissionAssignment'
        '401':
          description: ì¸ì¦ ì‹¤íŒ¨ (í† í° ì—†ìŒ ë˜ëŠ” ìœ íš¨í•˜ì§€ ì•ŠìŒ)
        '500':
          $ref: '#/components/responses/ServerError'

  /missions/assign:
    post:
      tags:
        - Mission
      summary: íŠ¹ì • ì½”ë“œ ë¯¸ì…˜ì„ ì˜¤ëŠ˜ìë¡œ ê°•ì œ ë°°ì •
      description: |
        í”„ë¡ íŠ¸ì—ì„œ ì§€ì •í•œ ë¯¸ì…˜ ì½”ë“œ ëª©ë¡ì„ ì˜¤ëŠ˜ ë‚ ì§œì— í• ë‹¹í•©ë‹ˆë‹¤.
        ì´ë¯¸ ì˜¤ëŠ˜ ë°°ì •ëœ ì½”ë“œëŠ” ë¬´ì‹œí•˜ê³ , ì¡´ì¬í•˜ì§€ ì•ŠëŠ” ì½”ë“œëŠ” ê±´ë„ˆëœë‹ˆë‹¤.
      security:
        - BearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                codes:
                  type: array
                  items:
                    type: string
              required:
                - codes
      responses:
        '200':
          description: ì˜¤ëŠ˜ ë¯¸ì…˜ ëª©ë¡
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/MissionAssignment'
        '401':
          description: ì¸ì¦ ì‹¤íŒ¨ (í† í° ì—†ìŒ ë˜ëŠ” ìœ íš¨í•˜ì§€ ì•ŠìŒ)
        '500':
          $ref: '#/components/responses/ServerError'

  /missions/today:
    get:
      tags:
        - Mission
      summary: ì˜¤ëŠ˜ì˜ ë¯¸ì…˜ ì¡°íšŒ
      description: |
        ì¸ì¦ëœ ì‚¬ìš©ìì˜ ì˜¤ëŠ˜ ë‚ ì§œì— í• ë‹¹ëœ ë¯¸ì…˜ ëª©ë¡ì„ ì¡°íšŒí•©ë‹ˆë‹¤.
      security:
        - BearerAuth: []
      responses:
        '200':
          description: ë¯¸ì…˜ ì¡°íšŒ ì„±ê³µ
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/MissionAssignment'
        '401':
          description: ì¸ì¦ ì‹¤íŒ¨ (í† í° ì—†ìŒ ë˜ëŠ” ìœ íš¨í•˜ì§€ ì•ŠìŒ)
        '500':
          $ref: '#/components/responses/ServerError'
    delete:
      tags:
        - Mission
      summary: ì˜¤ëŠ˜ ë°°ì •ëœ ë¯¸ì…˜ ì´ˆê¸°í™”
      description: |
        í˜„ì¬ ì‚¬ìš©ìì—ê²Œ ì˜¤ëŠ˜ ë‚ ì§œë¡œ ë°°ì •ëœ ë¯¸ì…˜ì„ ëª¨ë‘ ì‚­ì œí•©ë‹ˆë‹¤.
        í…ŒìŠ¤íŠ¸ë‚˜ ì¬ì¶”ì²œì´ í•„ìš”í•  ë•Œ ì‚¬ìš©í•©ë‹ˆë‹¤.
      security:
        - BearerAuth: []
      responses:
        '200':
          description: ì´ˆê¸°í™” í›„ ì˜¤ëŠ˜ ë¯¸ì…˜ ëª©ë¡ (ë³´í†µ ë¹ˆ ë°°ì—´)
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/MissionAssignment'
        '401':
          description: ì¸ì¦ ì‹¤íŒ¨ (í† í° ì—†ìŒ ë˜ëŠ” ìœ íš¨í•˜ì§€ ì•ŠìŒ)
        '500':
          $ref: '#/components/responses/ServerError'

  /missions/{id}/complete:
    post:
      tags:
        - Mission
      summary: ë¯¸ì…˜ ì™„ë£Œ ì²˜ë¦¬
      description: |
        ì‚¬ìš©ìì˜ ì˜¤ëŠ˜ ë‚ ì§œì— í• ë‹¹ëœ íŠ¹ì • ë¯¸ì…˜ì„ ì™„ë£Œ ì²˜ë¦¬í•©ë‹ˆë‹¤.
        ì´ë¯¸ ì™„ë£Œëœ ë¯¸ì…˜ì— ëŒ€í•´ í˜¸ì¶œí•  ê²½ìš° ê²½í—˜ì¹˜ëŠ” ì§€ê¸‰ë˜ì§€ ì•Šê³  ìƒíƒœë§Œ ë°˜í™˜ë©ë‹ˆë‹¤.
      security:
        - BearerAuth: []
      parameters:
        - in: path
          name: id
          required: true
          description: ì™„ë£Œí•  ë¯¸ì…˜ ID
          schema:
            type: integer
      requestBody:
        required: false
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/MissionCompletionRequest'
      responses:
        '200':
          description: ë¯¸ì…˜ ì™„ë£Œ ì²˜ë¦¬ ì„±ê³µ
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/MissionCompletionResponse'
        '401':
          description: ì¸ì¦ ì‹¤íŒ¨ (í† í° ì—†ìŒ ë˜ëŠ” ìœ íš¨í•˜ì§€ ì•ŠìŒ)
        '400':
          description: ì˜ëª»ëœ ìš”ì²­ (ë¯¸ì…˜ ID ë˜ëŠ” í˜ì´ë¡œë“œ ì˜¤ë¥˜)
        '404':
          description: ì˜¤ëŠ˜ ë‚ ì§œì— í•´ë‹¹ ë¯¸ì…˜ì´ í• ë‹¹ë˜ì§€ ì•Šì€ ê²½ìš°
        '409':
          description: ë¯¸ì…˜ì„ ì™„ë£Œí•  ìˆ˜ ì—†ëŠ” ìƒíƒœì¸ ê²½ìš°
        '500':
          $ref: '#/components/responses/ServerError'
  # ==================== Realtime Speech API (WebSocket) ====================
  /chat/realtime:
    get:
      tags:
        - Realtime Speech
      summary: ì‹¤ì‹œê°„ ìŒì„± ëŒ€í™” WebSocket ì—°ê²° (í‹°ì¼“ í•„ìš”)
      description: |
        âš ï¸ **ì´ ì—”ë“œí¬ì¸íŠ¸ëŠ” WebSocket í”„ë¡œí† ì½œì„ ì‚¬ìš©í•©ë‹ˆë‹¤.**

        Swagger UIì—ì„œ ì§ì ‘ í…ŒìŠ¤íŠ¸í•  ìˆ˜ ì—†ìœ¼ë©°, WebSocket í´ë¼ì´ì–¸íŠ¸ë¥¼ ì‚¬ìš©í•´ì•¼ í•©ë‹ˆë‹¤.

        ## ğŸ” ë³´ì•ˆ ì¸ì¦ íë¦„ (HTTP í‹°ì¼“ ë°©ì‹)

        **ì¤‘ìš”**: ì´ WebSocketì— ì—°ê²°í•˜ê¸° ì „ì—, ë¨¼ì € `POST /chat/realtime/ticket`ìœ¼ë¡œ ì¼íšŒìš© í‹°ì¼“ì„ ë°œê¸‰ë°›ì•„ì•¼ í•©ë‹ˆë‹¤.

        ### 1ë‹¨ê³„: HTTPS APIë¡œ í‹°ì¼“ ë°œê¸‰
        ```http
        POST /chat/realtime/ticket
        Authorization: Bearer {JWT_ACCESS_TOKEN}
        Content-Type: application/json

        {
          "plantId": 1
        }
        ```

        **ì‘ë‹µ:**
        ```json
        {
          "code": 200,
          "data": {
            "ticket": "ì•ˆì „í•œ_ì¼íšŒìš©_í‹°ì¼“_ë¬¸ìì—´",
            "expiresIn": 30,
            "wsUrl": "wss://your-server.com/chat/realtime?ticket=..."
          }
        }
        ```

        ### 2ë‹¨ê³„: í‹°ì¼“ìœ¼ë¡œ WebSocket ì—°ê²°
        ```javascript
        const ws = new WebSocket(wsUrl); // ë˜ëŠ” ì§ì ‘ URL êµ¬ì„±
        // wss://your-server.com/chat/realtime?ticket={TICKET}
        ```

        ## ğŸ›¡ï¸ ë³´ì•ˆ ê°•í™” í¬ì¸íŠ¸

        âœ… **JWT í† í°ì´ WebSocketì„ í†µê³¼í•˜ì§€ ì•ŠìŒ**
        - JWTëŠ” ì•ˆì „í•œ HTTPS APIë¡œë§Œ ì „ì†¡ë©ë‹ˆë‹¤
        - ì¤‘ê°„ì ê³µê²©(MITM)ìœ¼ë¡œë¶€í„° í† í° ë³´í˜¸

        âœ… **ì¼íšŒìš© í‹°ì¼“**
        - í‹°ì¼“ì€ í•œ ë²ˆ ì‚¬ìš©ë˜ë©´ ì¦‰ì‹œ ì‚­ì œë©ë‹ˆë‹¤
        - ì¬ì‚¬ìš© ë¶ˆê°€ëŠ¥ (Replay Attack ë°©ì–´)

        âœ… **ì§§ì€ ìœ íš¨ ì‹œê°„**
        - í‹°ì¼“ ìœ íš¨ ê¸°ê°„: 30ì´ˆ
        - íƒ€ì´ë° ê³µê²© ë°©ì–´

        âœ… **WSS(WebSocket Secure) í•„ìˆ˜**
        - í”„ë¡œë•ì…˜ í™˜ê²½ì—ì„œëŠ” ë°˜ë“œì‹œ wss:// ì‚¬ìš©
        - ëª¨ë“  WebSocket í†µì‹  ì•”í˜¸í™”

        ## ğŸ“¡ ì—°ê²° ë°©ë²•

        ### WebSocket URL í˜•ì‹
        ```
        wss://your-server.com/chat/realtime?ticket={TICKET}
        ```

        ### ì¿¼ë¦¬ íŒŒë¼ë¯¸í„°
        - `ticket` (required): POST /chat/realtime/ticketì—ì„œ ë°œê¸‰ë°›ì€ ì¼íšŒìš© í‹°ì¼“

        âš ï¸ **ì¤‘ìš”**: í‹°ì¼“ì€ 30ì´ˆ ë‚´ì— ì‚¬ìš©í•´ì•¼ í•˜ë©°, í•œ ë²ˆë§Œ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

        ## ğŸ”„ ì´ë²¤íŠ¸ íë¦„

        ### ì—°ê²° ì§í›„ (ìë™)
        ì„œë²„ê°€ í‹°ì¼“ì„ ê²€ì¦í•˜ê³  ë‹¤ìŒ ë©”ì‹œì§€ë¥¼ ë³´ëƒ…ë‹ˆë‹¤:

        **ì¸ì¦ ì„±ê³µ**
        ```json
        {
          "type": "authenticated",
          "message": "ì¸ì¦ì´ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤."
        }
        ```

        **ì„¸ì…˜ ìƒì„± ì™„ë£Œ**
        ```json
        {
          "type": "session.created",
          "session": {
            "id": "sess_xxx",
            "model": "gpt-4o-realtime-preview-2024-12-17",
            "voice": "shimmer"
          }
        }
        ```

        ### 1. í´ë¼ì´ì–¸íŠ¸ â†’ ì„œë²„ (ì£¼ìš” ì´ë²¤íŠ¸)

        **ì˜¤ë””ì˜¤ ë°ì´í„° ì „ì†¡**
        ```json
        {
          "type": "input_audio_buffer.append",
          "audio": "base64_encoded_pcm16_audio"
        }
        ```

        **ì‘ë‹µ ìƒì„± ìš”ì²­**
        ```json
        {
          "type": "response.create"
        }
        ```

        **í…ìŠ¤íŠ¸ ë©”ì‹œì§€ ì „ì†¡**
        ```json
        {
          "type": "conversation.item.create",
          "item": {
            "type": "message",
            "role": "user",
            "content": [{"type": "input_text", "text": "ì•ˆë…•í•˜ì„¸ìš”"}]
          }
        }
        ```

        ### 2. ì„œë²„ â†’ í´ë¼ì´ì–¸íŠ¸ (ì£¼ìš” ì´ë²¤íŠ¸)

        **ì˜¤ë””ì˜¤ ìŠ¤íŠ¸ë¦¬ë° (ì‹¤ì‹œê°„)**
        ```json
        {
          "type": "response.audio.delta",
          "delta": "base64_encoded_audio_chunk"
        }
        ```

        **ìŒì„± ì¸ì‹ ì™„ë£Œ**
        ```json
        {
          "type": "conversation.item.input_audio_transcription.completed",
          "transcript": "ì‚¬ìš©ìê°€ ë§í•œ ë‚´ìš©"
        }
        ```

        **AI ì‘ë‹µ ì™„ë£Œ**
        ```json
        {
          "type": "response.done",
          "response": {
            "output": [{
              "type": "message",
              "content": [{"type": "text", "text": "AI ì‘ë‹µ"}]
            }]
          }
        }
        ```

        **ì—ëŸ¬ ì‘ë‹µ**
        ```json
        {
          "type": "error",
          "error": {
            "message": "ì—ëŸ¬ ë©”ì‹œì§€",
            "code": "error_code"
          }
        }
        ```

        ## ğŸ’¾ ëŒ€í™” íˆìŠ¤í† ë¦¬
        - ì—°ê²° ì‹œ ìë™ìœ¼ë¡œ ì´ì „ ëŒ€í™” 20ê°œ ë¡œë“œ
        - ì‹¤ì‹œê°„ìœ¼ë¡œ Redis/DBì— ìë™ ì €ì¥
        - ì„¸ì…˜ ID: `userId-plantId` í˜•ì‹

        ## ğŸ¨ íŠ¹ì§•
        - âœ… ì‹¤ì‹œê°„ ì–‘ë°©í–¥ ì˜¤ë””ì˜¤ ìŠ¤íŠ¸ë¦¬ë°
        - âœ… ìë™ ìŒì„± ì¸ì‹ (STT) ë° ìŒì„± í•©ì„± (TTS)
        - âœ… ì‹ë¬¼ ìºë¦­í„° ê¸°ë°˜ ë§ì¶¤í˜• ëŒ€í™”
        - âœ… ëŒ€í™” íˆìŠ¤í† ë¦¬ ìë™ ê´€ë¦¬
        - âœ… ì—…ê³„ í‘œì¤€ ë³´ì•ˆ ì¸ì¦ (HTTP í‹°ì¼“ ë°©ì‹)

        ## ğŸ”§ í´ë¼ì´ì–¸íŠ¸ ì˜ˆì‹œ (JavaScript)

        **React Native / ë¸Œë¼ìš°ì € / Node.js ëª¨ë‘ ë™ì¼:**
        ```javascript
        // 1. HTTPS APIë¡œ í‹°ì¼“ ë°œê¸‰ (JWTëŠ” ì•ˆì „í•œ í—¤ë”ë¡œ ì „ì†¡)
        const response = await fetch('https://your-server.com/chat/realtime/ticket', {
          method: 'POST',
          headers: {
            'Authorization': `Bearer ${jwt_token}`, // âœ… ì•ˆì „í•œ HTTPS
            'Content-Type': 'application/json',
          },
          body: JSON.stringify({ plantId: 1 }),
        });

        const { data } = await response.json();
        const { ticket, wsUrl } = data;

        // 2. í‹°ì¼“ìœ¼ë¡œ WebSocket ì—°ê²° (wss:// í•„ìˆ˜!)
        const ws = new WebSocket(wsUrl);

        ws.onopen = () => {
          console.log('âœ… ì—°ê²° ì„±ê³µ (ì´ë¯¸ ì¸ì¦ë¨)');
        };

        ws.onmessage = (event) => {
          const data = JSON.parse(event.data);
          console.log('ë°›ì€ ì´ë²¤íŠ¸:', data.type);

          switch (data.type) {
            case 'authenticated':
              console.log('âœ… ì¸ì¦ ì™„ë£Œ');
              break;
            case 'response.audio.delta':
              playAudio(data.delta);
              break;
            case 'conversation.item.input_audio_transcription.completed':
              console.log('ì¸ì‹ëœ í…ìŠ¤íŠ¸:', data.transcript);
              break;
            case 'error':
              console.error('ì—ëŸ¬:', data.error);
              break;
          }
        };

        ws.onerror = (error) => {
          console.error('WebSocket ì—ëŸ¬:', error);
        };

        ws.onclose = () => {
          console.log('ì—°ê²° ì¢…ë£Œ');
        };

        // 3. ì˜¤ë””ì˜¤ ì „ì†¡
        function sendAudio(audioBuffer) {
          ws.send(JSON.stringify({
            type: 'input_audio_buffer.append',
            audio: audioBuffer // Base64 encoded PCM16
          }));
        }
        ```

        ## ğŸ“š ìì„¸í•œ ë¬¸ì„œ
        - `REALTIME_API_GUIDE.md` - ì „ì²´ API ê°€ì´ë“œ
        - `SECURITY_WEBSOCKET.md` - ë³´ì•ˆ ì„¤ê³„ ìƒì„¸ ë¬¸ì„œ
        - `REACT_NATIVE_EXAMPLE.md` - React Native êµ¬í˜„ ì˜ˆì‹œ

      parameters:
        - in: query
          name: ticket
          required: true
          schema:
            type: string
          description: "POST /chat/realtime/ticketì—ì„œ ë°œê¸‰ë°›ì€ ì¼íšŒìš© í‹°ì¼“ (30ì´ˆ ìœ íš¨)"
          example: "abc123def456ghi789jkl012mno345pqr678stu901vwx234yz"
      responses:
        '101':
          description: |
            âœ… **WebSocket í”„ë¡œí† ì½œ ì—…ê·¸ë ˆì´ë“œ ì„±ê³µ**

            HTTP 101 Switching Protocols ì‘ë‹µ í›„ WebSocket ì—°ê²°ì´ ì„¤ì •ë©ë‹ˆë‹¤.
            ì´í›„ JSON í˜•ì‹ì˜ ì´ë²¤íŠ¸ë¥¼ ì£¼ê³ ë°›ìŠµë‹ˆë‹¤.
        '400':
          description: ì˜ëª»ëœ ìš”ì²­ (ticket ëˆ„ë½)
          content:
            application/json:
              schema:
                type: object
                properties:
                  type:
                    type: string
                    example: "error"
                  error:
                    type: object
                    properties:
                      message:
                        type: string
                        example: "í‹°ì¼“ì´ í•„ìš”í•©ë‹ˆë‹¤. POST /chat/realtime/ticketìœ¼ë¡œ ë¨¼ì € í‹°ì¼“ì„ ë°œê¸‰ë°›ìœ¼ì„¸ìš”."
                      code:
                        type: string
                        example: "missing_ticket"
        '401':
          description: ì¸ì¦ ì‹¤íŒ¨ (ìœ íš¨í•˜ì§€ ì•Šê±°ë‚˜ ë§Œë£Œëœ í‹°ì¼“)
          content:
            application/json:
              schema:
                type: object
                properties:
                  type:
                    type: string
                    example: "error"
                  error:
                    type: object
                    properties:
                      message:
                        type: string
                        example: "ìœ íš¨í•˜ì§€ ì•Šê±°ë‚˜ ë§Œë£Œëœ í‹°ì¼“ì…ë‹ˆë‹¤. ìƒˆë¡œìš´ í‹°ì¼“ì„ ë°œê¸‰ë°›ìœ¼ì„¸ìš”."
                      code:
                        type: string
                        example: "invalid_ticket"
        '404':
          description: ì‹ë¬¼ì„ ì°¾ì„ ìˆ˜ ì—†ìŒ
          content:
            application/json:
              schema:
                type: object
                properties:
                  type:
                    type: string
                    example: "error"
                  error:
                    type: object
                    properties:
                      message:
                        type: string
                        example: "ì‹ë¬¼ ì •ë³´ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤."
                      code:
                        type: string
                        example: "plant_not_found"
        '500':
          description: ì„œë²„ ì˜¤ë¥˜
          content:
            application/json:
              schema:
                type: object
                properties:
                  type:
                    type: string
                    example: "error"
                  error:
                    type: object
                    properties:
                      message:
                        type: string
                        example: "ì—°ê²° ì²˜ë¦¬ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤."
                      code:
                        type: string
                        example: "connection_error"

  # ==================== Multiplayer AR APIs (WebSocket) ====================
  /ar-multiplayer:
    get:
      tags:
        - Multiplayer AR
      summary: AR ë©€í‹°í”Œë ˆì´ì–´ WebSocket ì—°ê²° (í‹°ì¼“ í•„ìš”)
      description: |
        âš ï¸ **ì´ ì—”ë“œí¬ì¸íŠ¸ëŠ” WebSocket í”„ë¡œí† ì½œì„ ì‚¬ìš©í•©ë‹ˆë‹¤.**

        Swagger UIì—ì„œ ì§ì ‘ í…ŒìŠ¤íŠ¸í•  ìˆ˜ ì—†ìœ¼ë©°, WebSocket í´ë¼ì´ì–¸íŠ¸ë¥¼ ì‚¬ìš©í•´ì•¼ í•©ë‹ˆë‹¤.

        ## ğŸ” ë³´ì•ˆ ì¸ì¦ íë¦„ (HTTP í‹°ì¼“ ë°©ì‹)

        **ì¤‘ìš”**: ì´ WebSocketì— ì—°ê²°í•˜ê¸° ì „ì—, ë¨¼ì € `POST /ar-multiplayer/ticket`ìœ¼ë¡œ ì¼íšŒìš© í‹°ì¼“ì„ ë°œê¸‰ë°›ì•„ì•¼ í•©ë‹ˆë‹¤.

        ### 1ë‹¨ê³„: HTTPS APIë¡œ í‹°ì¼“ ë°œê¸‰
        ```http
        POST /ar-multiplayer/ticket
        Authorization: Bearer {JWT_ACCESS_TOKEN}
        Content-Type: application/json

        {
          "roomId": "room_123"
        }
        ```

        **ì‘ë‹µ:**
        ```json
        {
          "code": 200,
          "data": {
            "ticket": "ì•ˆì „í•œ_ì¼íšŒìš©_í‹°ì¼“_ë¬¸ìì—´",
            "expiresIn": 30,
            "wsUrl": "wss://your-server.com/ar-multiplayer?ticket=..."
          }
        }
        ```

        ### 2ë‹¨ê³„: í‹°ì¼“ìœ¼ë¡œ WebSocket ì—°ê²°
        ```javascript
        const ws = new WebSocket(wsUrl);
        // wss://your-server.com/ar-multiplayer?ticket={TICKET}
        ```

        ## ğŸ›¡ï¸ ë³´ì•ˆ ê°•í™” í¬ì¸íŠ¸

        âœ… **ì¼íšŒìš© í‹°ì¼“**
        - í‹°ì¼“ì€ í•œ ë²ˆ ì‚¬ìš©ë˜ë©´ ì¦‰ì‹œ ì‚­ì œë©ë‹ˆë‹¤
        - ì¬ì‚¬ìš© ë¶ˆê°€ëŠ¥ (Replay Attack ë°©ì–´)

        âœ… **ì§§ì€ ìœ íš¨ ì‹œê°„**
        - í‹°ì¼“ ìœ íš¨ ê¸°ê°„: 30ì´ˆ
        - íƒ€ì´ë° ê³µê²© ë°©ì–´

        âœ… **Heartbeat ë©”ì»¤ë‹ˆì¦˜**
        - 30ì´ˆë§ˆë‹¤ Ping-Pong ì²´í¬
        - ì¢€ë¹„ ì—°ê²° ìë™ ê°ì§€ ë° ì¢…ë£Œ

        âœ… **ë©”ì‹œì§€ í¬ê¸° ì œí•œ**
        - ìµœëŒ€ 10KBë¡œ ì œí•œ
        - DoS ê³µê²© ë°©ì–´

        ## ğŸ“¡ ì—°ê²° ë°©ë²•

        ### WebSocket URL í˜•ì‹
        ```
        wss://your-server.com/ar-multiplayer?ticket={TICKET}
        ```

        ### ì¿¼ë¦¬ íŒŒë¼ë¯¸í„°
        - `ticket` (required): POST /ar-multiplayer/ticketì—ì„œ ë°œê¸‰ë°›ì€ ì¼íšŒìš© í‹°ì¼“

        âš ï¸ **ì¤‘ìš”**: í‹°ì¼“ì€ 30ì´ˆ ë‚´ì— ì‚¬ìš©í•´ì•¼ í•˜ë©°, í•œ ë²ˆë§Œ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

        ## ğŸ”„ ì´ë²¤íŠ¸ íë¦„

        ### ì—°ê²° ì§í›„ (ìë™)
        ì„œë²„ê°€ í‹°ì¼“ì„ ê²€ì¦í•˜ê³  ë‹¤ìŒ ë©”ì‹œì§€ë¥¼ ë³´ëƒ…ë‹ˆë‹¤:

        **ì¸ì¦ ì„±ê³µ**
        ```json
        {
          "type": "authenticated",
          "payload": {
            "message": "Authentication successful!",
            "userId": 1
          }
        }
        ```

        **í˜„ì¬ ë°©ì˜ ì‚¬ìš©ì ëª©ë¡**
        ```json
        {
          "type": "room-state",
          "payload": {
            "users": [
              {
                "userId": 2,
                "userName": "ì¹œêµ¬1",
                "position": [0, 0, -2],
                "rotation": [0, 0, 0],
                "expression": "default",
                "animation": "idle"
              }
            ]
          }
        }
        ```

        ### í´ë¼ì´ì–¸íŠ¸ â†’ ì„œë²„ ë©”ì‹œì§€

        **AR ìœ„ì¹˜/íšŒì „ ì—…ë°ì´íŠ¸**
        ```json
        {
          "type": "update",
          "payload": {
            "data": {
              "position": [1.5, 0, -3],
              "rotation": [0, 45, 0],
              "expression": "smile"
            }
          }
        }
        ```

        **ì• ë‹ˆë©”ì´ì…˜ ì‹¤í–‰**
        ```json
        {
          "type": "animation",
          "payload": {
            "data": {
              "animation": "wave"
            }
          }
        }
        ```

        ### ì„œë²„ â†’ í´ë¼ì´ì–¸íŠ¸ ë©”ì‹œì§€

        **ìƒˆ ì‚¬ìš©ì ì…ì¥**
        ```json
        {
          "type": "user-joined",
          "payload": {
            "userId": 3,
            "userName": "ì¹œêµ¬2",
            "position": [0, 0, -2],
            "rotation": [0, 0, 0],
            "expression": "default",
            "animation": "idle"
          }
        }
        ```

        **ì‚¬ìš©ì í‡´ì¥**
        ```json
        {
          "type": "user-left",
          "payload": {
            "userId": 3
          }
        }
        ```

        **ë‹¤ë¥¸ ì‚¬ìš©ìì˜ ìƒíƒœ ì—…ë°ì´íŠ¸**
        ```json
        {
          "type": "update",
          "payload": {
            "userId": 2,
            "data": {
              "position": [2, 0, -2.5],
              "rotation": [0, 90, 0],
              "expression": "happy"
            }
          }
        }
        ```

        ## âš™ï¸ AR ìƒíƒœ ê´€ë¦¬

        ì„œë²„ëŠ” ê° ì‚¬ìš©ìì˜ ë‹¤ìŒ ìƒíƒœë¥¼ ì¶”ì í•©ë‹ˆë‹¤:
        - **position**: [x, y, z] - AR ê³µê°„ì—ì„œì˜ ìœ„ì¹˜
        - **rotation**: [x, y, z] - AR ìºë¦­í„° íšŒì „
        - **expression**: í‘œì • (ì˜ˆ: default, smile, happy, sad)
        - **animation**: í˜„ì¬ ì¬ìƒ ì¤‘ì¸ ì• ë‹ˆë©”ì´ì…˜ (ì˜ˆ: idle, wave, dance)

        ## ğŸš¨ ì—ëŸ¬ ì²˜ë¦¬

        **í‹°ì¼“ì´ ì—†ëŠ” ê²½ìš° (1008)**
        ```
        WebSocket closed: Ticket required.
        ```

        **ìœ íš¨í•˜ì§€ ì•Šì€ í‹°ì¼“ (1008)**
        ```
        WebSocket closed: Invalid ticket.
        ```

        **ë©”ì‹œì§€ í¬ê¸° ì´ˆê³¼ (1009)**
        ```
        WebSocket closed: Message too large
        ```

        **Heartbeat íƒ€ì„ì•„ì›ƒ (ìë™ ì¢…ë£Œ)**
        - 30ì´ˆ ë™ì•ˆ Pong ì‘ë‹µì´ ì—†ìœ¼ë©´ ìë™ ì—°ê²° ì¢…ë£Œ

        ## ğŸ’¡ ì‚¬ìš© ì˜ˆì‹œ

        ```javascript
        // 1ë‹¨ê³„: í‹°ì¼“ ë°œê¸‰
        const response = await fetch('https://your-server.com/ar-multiplayer/ticket', {
          method: 'POST',
          headers: {
            'Authorization': `Bearer ${accessToken}`,
            'Content-Type': 'application/json'
          },
          body: JSON.stringify({ roomId: 'room_123' })
        });
        const { data } = await response.json();

        // 2ë‹¨ê³„: WebSocket ì—°ê²°
        const ws = new WebSocket(data.wsUrl);

        ws.onopen = () => {
          console.log('Connected to AR multiplayer room');
        };

        ws.onmessage = (event) => {
          const message = JSON.parse(event.data);

          switch(message.type) {
            case 'authenticated':
              console.log('Authenticated:', message.payload);
              break;
            case 'room-state':
              console.log('Room users:', message.payload.users);
              break;
            case 'user-joined':
              console.log('User joined:', message.payload);
              // AR ìºë¦­í„° ìƒì„±
              break;
            case 'user-left':
              console.log('User left:', message.payload.userId);
              // AR ìºë¦­í„° ì œê±°
              break;
            case 'update':
              console.log('User updated:', message.payload);
              // AR ìºë¦­í„° ìœ„ì¹˜/íšŒì „ ì—…ë°ì´íŠ¸
              break;
            case 'animation':
              console.log('Animation:', message.payload);
              // ì• ë‹ˆë©”ì´ì…˜ ì¬ìƒ
              break;
          }
        };

        // AR ìƒíƒœ ì „ì†¡
        function updateARState(position, rotation, expression) {
          ws.send(JSON.stringify({
            type: 'update',
            payload: {
              data: { position, rotation, expression }
            }
          }));
        }

        // ì• ë‹ˆë©”ì´ì…˜ ì „ì†¡
        function playAnimation(animationName) {
          ws.send(JSON.stringify({
            type: 'animation',
            payload: {
              data: { animation: animationName }
            }
          }));
        }
        ```
      parameters:
        - in: query
          name: ticket
          required: true
          schema:
            type: string
          description: "POST /ar-multiplayer/ticketì—ì„œ ë°œê¸‰ë°›ì€ ì¼íšŒìš© í‹°ì¼“ (30ì´ˆ ìœ íš¨)"
      responses:
        '101':
          description: |
            WebSocket ì—°ê²° ì—…ê·¸ë ˆì´ë“œ ì„±ê³µ (í”„ë¡œí† ì½œ ì „í™˜)

            ì´í›„ WebSocket í”„ë¡œí† ì½œë¡œ í†µì‹ í•©ë‹ˆë‹¤.
        '400':
          description: í‹°ì¼“ì´ ëˆ„ë½ë˜ì—ˆê±°ë‚˜ ìœ íš¨í•˜ì§€ ì•ŠìŒ
          content:
            text/plain:
              schema:
                type: string
                example: "Ticket required."
        '500':
          description: ì„œë²„ ì˜¤ë¥˜

  /ar-multiplayer/ticket:
    post:
      tags:
        - Multiplayer AR
      summary: AR ë©€í‹°í”Œë ˆì´ì–´ WebSocket ì—°ê²° í‹°ì¼“ ë°œê¸‰
      description: |
        AR ë©€í‹°í”Œë ˆì´ì–´ WebSocket ì—°ê²°ì„ ìœ„í•œ ì¼íšŒìš© í‹°ì¼“ì„ ë°œê¸‰í•©ë‹ˆë‹¤.

        **í‹°ì¼“ íŠ¹ì„±:**
        - 30ì´ˆê°„ ìœ íš¨
        - í•œ ë²ˆë§Œ ì‚¬ìš© ê°€ëŠ¥ (ì¼íšŒìš©)
        - Redisì— ì €ì¥ë˜ë©° ì‚¬ìš© ì‹œ ì¦‰ì‹œ ì‚­ì œ

        **ë°œê¸‰ëœ í‹°ì¼“ ì‚¬ìš©ë²•:**
        ```javascript
        const ws = new WebSocket(`wss://your-server.com/ar-multiplayer?ticket=${ticket}`);
        ```
      security:
        - BearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [roomId]
              properties:
                roomId:
                  type: string
                  description: "ì°¸ê°€í•  AR ë©€í‹°í”Œë ˆì´ì–´ ë°© ID"
                  example: "room_123"
      responses:
        '200':
          description: í‹°ì¼“ ë°œê¸‰ ì„±ê³µ
          content:
            application/json:
              schema:
                type: object
                properties:
                  code:
                    type: integer
                    example: 200
                  data:
                    type: object
                    properties:
                      ticket:
                        type: string
                        description: "ì¼íšŒìš© WebSocket ì—°ê²° í‹°ì¼“"
                        example: "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."
                      expiresIn:
                        type: integer
                        description: "í‹°ì¼“ ìœ íš¨ ì‹œê°„ (ì´ˆ)"
                        example: 30
                      wsUrl:
                        type: string
                        description: "í‹°ì¼“ì´ í¬í•¨ëœ WebSocket URL (ë°”ë¡œ ì‚¬ìš© ê°€ëŠ¥)"
                        example: "wss://leafy.wolyong.cloud/ar-multiplayer?ticket=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."
                  msg:
                    type: string
                    example: "Ok"
        '400':
          description: roomIdê°€ ëˆ„ë½ë¨
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
              example:
                code: 400
                msg: "roomId is required"
        '401':
          description: ì¸ì¦ ì‹¤íŒ¨ (í† í° ì—†ìŒ ë˜ëŠ” ìœ íš¨í•˜ì§€ ì•ŠìŒ)
        '500':
          description: í‹°ì¼“ ìƒì„± ì‹¤íŒ¨
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
              example:
                code: 500
                msg: "Ticket creation failed"

  # -------------------- Speech APIs --------------------
  /speech/stt:
    post:
      tags:
        - Speech
      summary: ìŒì„±ì„ í…ìŠ¤íŠ¸ë¡œ ë³€í™˜ (STT)
      description: |
        OGG(Opus) í˜•ì‹ì˜ ìŒì„± íŒŒì¼ì„ ë°›ì•„ í…ìŠ¤íŠ¸ë¡œ ë³€í™˜í•©ë‹ˆë‹¤.
        Access Tokenì—ì„œ userIdë¥¼ ìë™ìœ¼ë¡œ ì¶”ì¶œí•˜ì—¬ ì‚¬ìš©í•©ë‹ˆë‹¤.
      security:
        - BearerAuth: []
      requestBody:
        required: true
        content:
          multipart/form-data:
            schema:
              type: object
              required: [file, plantId]
              properties:
                file:
                  type: string
                  format: binary
                  description: "OGG_OPUS ì¸ì½”ë”©, 16000Hz ìƒ˜í”Œë§ ë ˆì´íŠ¸ì˜ ìŒì„± íŒŒì¼"
                plantId:
                  type: integer
                  description: "ëŒ€í™”í•  ì‹ë¬¼ ID"
                  example: 1
      responses:
        '200':
          description: STT ë³€í™˜ ì„±ê³µ
          content:
            application/json:
              schema:
                type: object
                properties:
                  code: { type: integer, example: 200 }
                  data:
                    type: string
                    description: "ë³€í™˜ëœ í…ìŠ¤íŠ¸"
                    example: "ì˜¤ëŠ˜ ë‚ ì”¨ ì •ë§ ì¢‹ë‹¤."
                  msg: { type: string, example: "Ok" }
        '400':
          description: ìŒì„± íŒŒì¼ì´ ì²¨ë¶€ë˜ì§€ ì•Šì€ ê²½ìš°
        '401':
          description: ì¸ì¦ ì‹¤íŒ¨ (í† í° ì—†ìŒ ë˜ëŠ” ìœ íš¨í•˜ì§€ ì•ŠìŒ)
        '500':
          $ref: '#/components/responses/ServerError'

  /speech/tts:
    post:
      tags:
        - Speech
      summary: í…ìŠ¤íŠ¸ë¥¼ ìŒì„±ìœ¼ë¡œ ë³€í™˜ (TTS)
      description: ì…ë ¥ëœ í…ìŠ¤íŠ¸ ë©”ì‹œì§€ë¥¼ OGG í˜•ì‹ì˜ ìŒì„± íŒŒì¼(Blob)ìœ¼ë¡œ ë³€í™˜í•˜ì—¬ ë°˜í™˜í•©ë‹ˆë‹¤.
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [message]
              properties:
                message:
                  type: string
                  description: "ìŒì„±ìœ¼ë¡œ ë³€í™˜í•  í…ìŠ¤íŠ¸"
                  example: "ì˜¤ëŠ˜ í•˜ë£¨ë„ ìˆ˜ê³  ë§ìœ¼ì…¨ì–´ìš”."
      responses:
        '200':
          description: TTS ë³€í™˜ ì„±ê³µ. audio/ogg í˜•ì‹ì˜ Blob ë°ì´í„°ë¥¼ ë°˜í™˜í•©ë‹ˆë‹¤.
          content:
            audio/ogg:
              schema:
                type: string
                format: binary
        '400':
          description: ë³€í™˜í•  ë©”ì‹œì§€ê°€ ì—†ëŠ” ê²½ìš°
        '500':
          $ref: '#/components/responses/ServerError'


# ===============================================================
# == Components (ì „ì²´ ê¸°ëŠ¥ ìµœì¢… í†µí•©ë³¸)
# ===============================================================
components:
  # -------------------- Security Schemes --------------------
  securitySchemes:
    BearerAuth:
      type: http
      scheme: bearer
      bearerFormat: JWT
      description: "ë¡œê·¸ì¸ ì‹œ ë°œê¸‰ë°›ì€ JWT í† í°ì„ 'Bearer {token}' í˜•ì‹ìœ¼ë¡œ ì…ë ¥í•˜ì„¸ìš”."

  # -------------------- Schemas (ëª¨ë“  ëª¨ë¸/ìš”ì²­/ì‘ë‹µ) --------------------
  schemas:
    # -------------------- User Schemas --------------------
    User:
      type: object
      description: ì‚¬ìš©ì ì •ë³´ ìŠ¤í‚¤ë§ˆ (DB ëª¨ë¸ ê¸°ì¤€)
      properties:
        user_id:
          type: integer
          description: "ì‚¬ìš©ì ê³ ìœ  ID"
          readOnly: true
        user_email:
          type: string
          format: email
        user_name:
          type: string
        user_gender:
          type: string
        state:
          type: string
          description: "ì‚¬ìš©ìì˜ í˜„ì¬ ê°ì • ìƒíƒœ (ì˜ˆ: í–‰ë³µ, ìŠ¬í””, ì¤‘ë¦½)"
          nullable: true
        created_at:
          type: string
          format: date-time
          description: "ê³„ì • ìƒì„±ì¼"
          readOnly: true

    UserRegisterRequest:
      type: object
      description: íšŒì›ê°€ì… ìš”ì²­ ì‹œ Bodyì— í¬í•¨ë  ë°ì´í„°
      required:
        - user_name
        - user_email
        - password
        - user_gender
      properties:
        user_name:
          type: string
          example: "ê¹€Inner"
        user_email:
          type: string
          format: email
          example: "innerecho@example.com"
        password:
          type: string
          format: password
          description: "ì•”í˜¸í™”ë˜ì–´ ì €ì¥ë  ì‚¬ìš©ì ë¹„ë°€ë²ˆí˜¸"
          example: "password123!"
        user_gender:
          type: string
          example: "ë‚¨ì„±"

    UserLoginRequest:
      type: object
      description: ë¡œê·¸ì¸ ìš”ì²­ ì‹œ Bodyì— í¬í•¨ë  ë°ì´í„°
      required:
        - user_email
        - password
      properties:
        user_email:
          type: string
          format: email
          example: "innerecho@example.com"
        password:
          type: string
          format: password
          example: "password123!"

    DecodedToken:
      type: object
      description: JWT í† í°ì„ ë””ì½”ë”©í–ˆì„ ë•Œ ì–»ì„ ìˆ˜ ìˆëŠ” ì‚¬ìš©ì ì •ë³´ í˜ì´ë¡œë“œ
      properties:
        userId:
          type: integer
        userEmail:
          type: string
          format: email
        userName:
          type: string
        state:
          type: string
          nullable: true

    # -------------------- Plant & Chat Schemas --------------------
    UserPlant:
      type: object
      description: ì‚¬ìš©ìê°€ ì†Œìœ í•œ ì‹ë¬¼ ì •ë³´ ìŠ¤í‚¤ë§ˆ (DB ëª¨ë¸ ê¸°ì¤€)
      properties:
        plantId:
          type: integer
          readOnly: true
        user_id:
          type: integer
        species_id:
          type: integer
        nickname:
          type: string
          description: "ì‹ë¬¼ì˜ ì• ì¹­"
          example: "ê¸ˆìª½ì´"
        plant_level:
          type: integer
          description: "ì‹ë¬¼ ë ˆë²¨"
          example: 1
        plant_experience:
          type: integer
          description: "ì‹ë¬¼ ê²½í—˜ì¹˜"
          example: 50
        plant_hogamdo:
          type: integer
          description: "ì‹ë¬¼ê³¼ì˜ í˜¸ê°ë„"
          example: 10
        last_measured_date:
          type: string
          format: date-time
          description: "ë§ˆì§€ë§‰ìœ¼ë¡œ ìƒíƒœë¥¼ ì¸¡ì •í•œ ë‚ ì§œ"

    ChatHistory:
      type: object
      description: ì±„íŒ… ê¸°ë¡ ìŠ¤í‚¤ë§ˆ (API ì‘ë‹µ í˜•ì‹)
      properties:
        userId:
          type: integer
          description: "ì‚¬ìš©ì ID"
          example: 1
        plantId:
          type: integer
          description: "ì‹ë¬¼ ID"
          example: 1
        message:
          type: string
          description: "ë©”ì‹œì§€ ë‚´ìš©"
          example: "ì˜¤ëŠ˜ í•˜ë£¨ ì–´ë• ì–´?"
        sendDate:
          type: string
          format: date-time
          description: "ë©”ì‹œì§€ ì „ì†¡ ì‹œê°„"
          example: "2025-10-15T12:34:56.789Z"
        userType:
          type: string
          enum: [User, Bot]
          description: "ë©”ì‹œì§€ ë°œì‹ ì (User: ì‚¬ìš©ì, Bot: ì±—ë´‡)"
          example: "User"

    ChatRequest:
      type: object
      description: |
        ì±—ë´‡ì—ê²Œ ë©”ì‹œì§€ ì „ì†¡ ì‹œ Bodyì— í¬í•¨ë  ë°ì´í„°.
        userIdëŠ” Access Tokenì—ì„œ ìë™ìœ¼ë¡œ ì¶”ì¶œë©ë‹ˆë‹¤.
      required:
        - plantId
        - message
      properties:
        plantId:
          type: integer
          description: "ëŒ€í™”í•  ì‹ë¬¼ ID"
          example: 1
        message:
          type: string
          description: "ì‚¬ìš©ìê°€ ì…ë ¥í•œ ë©”ì‹œì§€"
          example: "ì˜¤ëŠ˜ í•˜ë£¨ ì–´ë• ì–´?"
        emotion:
          type: string
          description: "(ì„ íƒ) ì‚¬ìš©ìì˜ í˜„ì¬ ê°ì • ìƒíƒœ. ì±—ë´‡ ë‹µë³€ì— ì˜í–¥ì„ ì¤„ ìˆ˜ ìˆìŠµë‹ˆë‹¤."
          nullable: true
          example: "í–‰ë³µ"

    # -------------------- Diary Schemas --------------------
    GrowthDiary:
      type: object
      description: ì„±ì¥ ì¼ê¸° ìŠ¤í‚¤ë§ˆ (DB ëª¨ë¸ ê¸°ì¤€)
      properties:
        diary_id:
          type: integer
          readOnly: true
        user_id:
          type: integer
        title:
          type: string
          example: "ê¸ˆìª½ì´ì™€ì˜ í•˜ë£¨"
        content:
          type: string
          example: "ì˜¤ëŠ˜ ê¸ˆìª½ì´ì™€ ë§ì€ ì´ì•¼ê¸°ë¥¼ ë‚˜ëˆ„ì—ˆë‹¤. í–‰ë³µí•œ í•˜ë£¨ì˜€ë‹¤."
        image_url:
          type: string
          nullable: true
        created_at:
          type: string
          format: date-time
        updated_at:
          type: string
          format: date-time
        is_deleted:
          type: boolean
        edited:
          type: boolean

    DiaryCreateRequest:
      type: object
      description: |
        ì¼ê¸° ìƒì„± ìš”ì²­ ë°ì´í„°.
        userIdëŠ” Access Tokenì—ì„œ ìë™ìœ¼ë¡œ ì¶”ì¶œë©ë‹ˆë‹¤.
      required: [plantId, message]
      properties:
        plantId:
          type: integer
          example: 1
        message:
          type: string
          example: "ì˜¤ëŠ˜ í•˜ë£¨ë¥¼ ì¼ê¸°ë¡œ ë§Œë“¤ì–´ì¤˜."

    # -------------------- Comment Schemas --------------------
    GrowthDiaryComment:
      type: object
      description: ì„±ì¥ ì¼ê¸° ëŒ“ê¸€ ìŠ¤í‚¤ë§ˆ (DB ëª¨ë¸ ê¸°ì¤€)
      properties:
        comment_id:
          type: integer
        diary_id:
          type: integer
        user_id:
          type: integer
        content:
          type: string
        created_at:
          type: string
          format: date-time
        updated_at:
          type: string
          format: date-time

    CommentCreateRequest:
      type: object
      description: |
        ëŒ“ê¸€ ìƒì„± ìš”ì²­ ë°ì´í„°.
        userIdì™€ diaryIdëŠ” í† í° ë° URLì—ì„œ ìë™ìœ¼ë¡œ ì¶”ì¶œë©ë‹ˆë‹¤.
      required: [content]
      properties:
        content:
          type: string
          description: "ëŒ“ê¸€ ë‚´ìš©"
          example: "ì¢‹ì€ ê¸€ì´ë„¤ìš”!"

    CommentUpdateRequest:
      type: object
      description: |
        ëŒ“ê¸€ ìˆ˜ì • ìš”ì²­ ë°ì´í„°.
        userId, diaryId, commentIdëŠ” í† í° ë° URLì—ì„œ ìë™ìœ¼ë¡œ ì¶”ì¶œë©ë‹ˆë‹¤.
      required: [content]
      properties:
        content:
          type: string
          description: "ìˆ˜ì •í•  ëŒ“ê¸€ ë‚´ìš©"
          example: "ìˆ˜ì •ëœ ëŒ“ê¸€ ë‚´ìš©ì…ë‹ˆë‹¤!"

    CommentDeleteRequest:
      type: object
      description: |
        ëŒ“ê¸€ ì‚­ì œ ìš”ì²­ ë°ì´í„°.
        userId, diaryId, commentIdëŠ” í† í° ë° URLì—ì„œ ìë™ìœ¼ë¡œ ì¶”ì¶œë©ë‹ˆë‹¤.
        ìš”ì²­ bodyê°€ í•„ìš” ì—†ìŠµë‹ˆë‹¤.

    # -------------------- Response Schemas --------------------
    UserResponse:
      type: object
      description: ì‚¬ìš©ì ê´€ë ¨ APIì˜ ê¸°ë³¸ ì„±ê³µ ì‘ë‹µ
      properties:
        code:
          type: integer
          example: 200
        data:
          $ref: '#/components/schemas/User'
        msg:
          type: string
          example: "Ok"

    TokenResponse:
      type: object
      description: ë¡œê·¸ì¸ ì„±ê³µ ì‹œ ë°˜í™˜ë˜ëŠ” JWT í† í° ì‘ë‹µ
      properties:
        code:
          type: integer
          example: 200
        data:
          type: string
          description: "API ì¸ì¦ì— ì‚¬ìš©ë  JWT Access Token"
          example: "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VyX2lkIjoxLCJpYXQiOjE2MTYyMzkwMjJ9.SflKxwRJSMeKKF2QT4fwpMeJf36POk6yJV_adQssw5c"
        msg:
          type: string
          example: "Ok"

    PlantStateResponse:
      type: object
      description: ì‹ë¬¼ ìƒíƒœ ì¡°íšŒ ì„±ê³µ ì‘ë‹µ
      properties:
        code:
          type: integer
          example: 200
        data:
          type: object
          properties:
            plantName:
              type: string
              description: "ì‹ë¬¼ ì• ì¹­"
              example: "ê¸ˆìª½ì´"
            level:
              type: integer
              example: 1
            experience:
              type: integer
              example: 50
            likeability:
              type: integer
              description: "í˜¸ê°ë„"
              example: 10
        msg:
          type: string
          example: "Ok"

    ChatResponse:
      type: object
      description: ì±—ë´‡ ëŒ€í™” ì„±ê³µ ì‘ë‹µ
      properties:
        code:
          type: integer
          example: 200
        data:
          type: object
          properties:
            userId:
              type: integer
              example: 1
            plantId:
              type: integer
              example: 1
            message:
              type: string
              description: "ì±—ë´‡ì˜ ì‘ë‹µ ë©”ì‹œì§€"
              example: "ì˜¤ëŠ˜ í•˜ë£¨ë„ ì •ë§ ì¦ê±°ì› ì–´ìš”! ì£¼ì¸ë‹˜ì€ ì–´ë– ì…¨ë‚˜ìš”?"
            userType:
              type: string
              example: "Bot"
            sendDate:
              type: string
              format: date-time
        msg:
          type: string
          example: "Ok"

    DiaryResponse:
      type: object
      description: ì¼ê¸° ìƒì„± ë° ì¡°íšŒ ì„±ê³µ ì‘ë‹µ
      properties:
        code:
          type: integer
          example: 200
        data:
          $ref: '#/components/schemas/GrowthDiary'
        msg:
          type: string
          example: "Ok"

    CommentResponse:
      type: object
      description: ëŒ“ê¸€ ìƒì„± ë° ìˆ˜ì • ì„±ê³µ ì‘ë‹µ
      properties:
        code:
          type: integer
          example: 200
        data:
          $ref: '#/components/schemas/GrowthDiaryComment'
        msg:
          type: string
          example: "Ok"

    ErrorResponse:
      type: object
      description: API ì‹¤íŒ¨ ì‹œ ê³µí†µ ì‘ë‹µ
      properties:
        code:
          type: integer
        msg:
          type: string

    AuthV2ErrorResponse:
      type: object
      description: Auth V2 API ì‹¤íŒ¨ ì‹œ ì‘ë‹µ í˜•ì‹
      properties:
        code:
          type: integer
          example: 400
        message:
          type: string
          example: "Error message"
        error:
          type: string
          example: "ERROR_CODE"
    FriendRequest:
      type: object
      required: [fromUserId, toUserId]
      properties:
        fromUserId:
          type: integer
          description: "ìš”ì²­ì„ ë³´ë‚´ëŠ” ì‚¬ìš©ì ID"
        toUserId:
          type: integer
          description: "ìš”ì²­ì„ ë°›ëŠ” ì‚¬ìš©ì ID"

    FriendSummary:
      type: object
      description: "ì¹œêµ¬ ëª©ë¡ í•­ëª©"
      properties:
        requestId:
          type: integer
          description: "ì¹œêµ¬ ê´€ê³„ì— ëŒ€ì‘í•˜ëŠ” friend_id"
          example: 140
        friend:
          type: object
          properties:
            userId:
              type: integer
              example: 31
            email:
              type: string
              format: email
              example: "mock+a1_002@example.com"
            name:
              type: string
              nullable: true
              example: "mockUser"

    FriendList:
      type: array
      description: "ì¹œêµ¬ ëª©ë¡"
      items:
        $ref: '#/components/schemas/FriendSummary'

    FriendRequestParticipant:
      type: object
      properties:
        userId:
          type: integer
          example: 47
        email:
          type: string
          format: email
        name:
          type: string
          nullable: true

    FriendRequestItem:
      type: object
      description: "ì¹œêµ¬ ìš”ì²­ ì •ë³´"
      properties:
        requestId:
          type: integer
          example: 89
        status:
          type: string
          enum: ["pending", "accepted", "rejected", "blocked"]
          example: "pending"
        direction:
          type: string
          enum: ["inbound", "outbound"]
          example: "inbound"
        from:
          $ref: '#/components/schemas/FriendRequestParticipant'
        to:
          $ref: '#/components/schemas/FriendRequestParticipant'

    FriendRequestList:
      type: array
      description: "ì¹œêµ¬ ìš”ì²­ ëª©ë¡"
      items:
        $ref: '#/components/schemas/FriendRequestItem'

    FriendRecommendationCandidate:
      type: object
      description: ì¶”ì²œëœ ì¹œêµ¬ í›„ë³´ ìƒì„¸ ì •ë³´
      properties:
        userId:
          type: integer
          description: "ì¶”ì²œëœ ì‚¬ìš©ì ID"
        score:
          type: number
          format: float
          description: "0~1 ì‚¬ì´ì˜ ë°˜ëŒ€ ë§¤ì¹­ ì ìˆ˜ (1ì— ê°€ê¹Œìš¸ìˆ˜ë¡ ëŒ€ë¹„ë˜ëŠ” ì„±í–¥)"
        activityBias:
          type: number
          format: float
          description: "í™œë™ì„± í¸í–¥ (ìŒìˆ˜=ê³ ìš”, ì–‘ìˆ˜=í™œë™)"
        arScore:
          type: number
          format: float
          description: "AR ì„ í˜¸ë„ (0~1)"
        burdenScore:
          type: number
          format: float
          description: "ë¶€ë‹´ ì„ í˜¸ë„ (0~1 ì •ê·œí™”)"
        timeBias:
          type: number
          format: float
          description: "ì‹œê°„ëŒ€ í¸í–¥ (ìŒìˆ˜=ì£¼ê°„, ì–‘ìˆ˜=ì•¼ê°„)"
        samples:
          type: integer
          description: "ì§‘ê³„ì— ì‚¬ìš©ëœ ë¯¸ì…˜ ìƒ˜í”Œ ìˆ˜"

    FriendRecommendationResult:
      type: object
      description: ì¹œêµ¬ ì¶”ì²œ API ì‘ë‹µ ë°ì´í„°
      properties:
        userId:
          type: integer
          description: "ìš”ì²­í•œ ì‚¬ìš©ì ID"
        topN:
          type: integer
          description: "ìš”ì²­ëœ ì¶”ì²œ ê°œìˆ˜"
        results:
          type: array
          items:
            $ref: '#/components/schemas/FriendRecommendationCandidate'

    MissionDetails:
      type: object
      description: "ë¯¸ì…˜ ê¸°ë³¸ ì •ë³´"
      required:
        - missionId
        - code
        - title
        - type
        - burden
        - expReward
        - arBonusExp
        - cooldownSec
        - isActive
      properties:
        missionId:
          type: integer
          description: "ë¯¸ì…˜ ID"
          example: 1
        code:
          type: string
          description: "ë¯¸ì…˜ ì½”ë“œ"
          example: "APP_OPEN"
        title:
          type: string
          description: "ë¯¸ì…˜ ì œëª©"
          example: "Open the app"
        desc:
          type: string
          nullable: true
          description: "ë¯¸ì…˜ ì„¤ëª…"
        type:
          type: string
          description: "ë¯¸ì…˜ íƒ€ì…"
          enum: [instant, action, ar_optional, habit]
        burden:
          type: integer
          description: "ë¯¸ì…˜ ë‚œì´ë„/ë¶€ë‹´ë„"
          example: 1
        expReward:
          type: integer
          description: "ê¸°ë³¸ ê²½í—˜ì¹˜ ë³´ìƒ"
          example: 5
        arBonusExp:
          type: integer
          description: "AR ì¡°ê±´ ë‹¬ì„± ì‹œ ì¶”ê°€ ê²½í—˜ì¹˜"
          example: 3
        requiresArAction:
          type: string
          nullable: true
          description: "ìš”êµ¬ë˜ëŠ” AR ë™ì‘"
          enum: [PET, JUMP, WATER, SUNLIGHT, null]
        cooldownSec:
          type: integer
          description: "ì¿¨ë‹¤ìš´ ì‹œê°„(ì´ˆ)"
          example: 0
        isActive:
          type: integer
          description: "ë¯¸ì…˜ í™œì„±í™” ì—¬ë¶€ (1/0)"
          example: 1

    MissionAssignment:
      type: object
      description: "ì‚¬ìš©ìì—ê²Œ í• ë‹¹ëœ ë¯¸ì…˜ ì •ë³´"
      required:
        - userMissionId
        - missionId
        - status
        - assignedAt
      properties:
        userMissionId:
          type: integer
          description: "user_missions í…Œì´ë¸” ID"
          example: 12
        missionId:
          type: integer
          description: "ë¯¸ì…˜ ID"
          example: 4
        status:
          type: string
          description: "ë¯¸ì…˜ ìƒíƒœ"
          enum: [assigned, complete, skipped, expired]
          example: "assigned"
        assignedAt:
          type: string
          format: date-time
          description: "ë¯¸ì…˜ì´ ì‚¬ìš©ìì—ê²Œ í• ë‹¹ëœ ì‹œê°"
        expiresAt:
          type: string
          format: date-time
          nullable: true
          description: "ë¯¸ì…˜ ë§Œë£Œ ì‹œê°"

    MissionCompletionRequest:
      type: object
      properties:
        plantId:
          type: integer
          description: "ê²½í—˜ì¹˜ë¥¼ ì§€ê¸‰í•  ì‹ë¬¼ ID (ìƒëµ ì‹œ ê¸°ë³¸ ì‹ë¬¼ ìë™ ì„ íƒ)"
          example: 1
        evidence:
          description: "ë¯¸ì…˜ ì™„ë£Œë¥¼ ì¦ë¹™í•˜ëŠ” ë°ì´í„° (JSON ë˜ëŠ” ë¬¸ìì—´)"
          oneOf:
            - type: string
            - type: object
              additionalProperties: true
          nullable: true

    PlantStatus:
      type: object
      description: "ë¯¸ì…˜ ì™„ë£Œ í›„ì˜ ì‹ë¬¼ ìƒíƒœ ì •ë³´"
      properties:
        plantId:
          type: integer
          nullable: true
          description: "ì‹ë¬¼ ID (ì„ íƒì )"
        plantName:
          type: string
          nullable: true
          description: "ì‹ë¬¼ ì´ë¦„ (ì„ íƒì )"
        level:
          type: integer
          description: "í˜„ì¬ ë ˆë²¨"
          example: 3
        experience:
          type: integer
          description: "í˜„ì¬ ê²½í—˜ì¹˜"
          example: 45
        leveledUp:
          type: boolean
          nullable: true
          description: "ë ˆë²¨ì—… ì—¬ë¶€ (ê²½í—˜ì¹˜ ì§€ê¸‰ ì‹œ ì‚¬ìš©)"
        likeability:
          type: integer
          nullable: true
          description: "í˜¸ê°ë„ (ì´ë¯¸ ì™„ë£Œëœ ë¯¸ì…˜ ì¡°íšŒ ì‹œ í¬í•¨ë  ìˆ˜ ìˆìŒ)"

    MissionCompletionResponse:
      type: object
      required:
        - message
        - baseExp
        - arBonus
        - expGained
        - plantStatus
      properties:
        message:
          type: string
          description: "ì²˜ë¦¬ ê²°ê³¼ ë©”ì‹œì§€"
          example: "Mission completed"
        baseExp:
          type: integer
          description: "ë¯¸ì…˜ ê¸°ë³¸ ê²½í—˜ì¹˜"
          example: 5
        arBonus:
          type: integer
          description: "AR ì¶”ê°€ ê²½í—˜ì¹˜ (ì¡°ê±´ ì¶©ì¡± ì‹œ)"
          example: 3
        expGained:
          type: integer
          description: "ì´ íšë“ ê²½í—˜ì¹˜"
          example: 8
        plantStatus:
          $ref: '#/components/schemas/PlantStatus'


  # -------------------- Responses (ê³µí†µ ì‘ë‹µ) --------------------
  responses:
    ServerError:
      description: ì„œë²„ ë‚´ë¶€ ì˜¤ë¥˜
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/ErrorResponse'
          example:
            code: 500
            msg: "ServerError"
            
    UnauthorizedError:
      description: ì¸ì¦ ì‹¤íŒ¨ (í† í°ì´ ì—†ê±°ë‚˜ ìœ íš¨í•˜ì§€ ì•ŠìŒ)
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/ErrorResponse'
          example:
            code: 401
            msg: "ìœ íš¨í•˜ì§€ ì•Šì€ í† í°ì…ë‹ˆë‹¤."
