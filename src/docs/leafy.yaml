openapi: 3.0.1
info:
  title: InnerEcho API - (1) User
  description: InnerEcho ì„œë¹„ìŠ¤ì˜ ì‚¬ìš©ì ì¸ì¦ ë° ì •ë³´ ì¡°íšŒ API ëª…ì„¸ì„œì…ë‹ˆë‹¤.
  version: 1.0.1

servers:
  - url: http://localhost:3001
    description: ë¡œì»¬ ê°œë°œ ì„œë²„

tags:
  - name: User
    description: "ğŸ§‘â€ğŸ¤â€ğŸ§‘ ì‚¬ìš©ì íšŒì›ê°€ì…, ë¡œê·¸ì¸, ì¸ì¦ ë° ì •ë³´ ì¡°íšŒ API"
  - name: Plant
    description: "ğŸŒ± ì‚¬ìš©ìì˜ ì‹ë¬¼ ìƒíƒœ(ë ˆë²¨, ê²½í—˜ì¹˜, í˜¸ê°ë„) ì¡°íšŒ API"
  - name: Chat
    description: "ğŸ’¬ ì‹ë¬¼ ì±—ë´‡ê³¼ì˜ ëŒ€í™” ë° ì´ì „ ëŒ€í™” ê¸°ë¡ ì¡°íšŒ API"
  - name: Diary
    description: "ğŸ“” ì„±ì¥ ì¼ê¸° CRUD API"
  - name: Comment
    description: "âœï¸ ì„±ì¥ ì¼ê¸° ëŒ“ê¸€ CRUD API"

# ===============================================================
# == Paths (Endpoints)
# ===============================================================
paths:
  /user/register:
    post:
      tags:
        - User
      summary: ì‚¬ìš©ì íšŒì›ê°€ì…
      description: ìƒˆë¡œìš´ ì‚¬ìš©ìë¥¼ ë“±ë¡í•©ë‹ˆë‹¤. ì„±ê³µ ì‹œ, í•´ë‹¹ ì‚¬ìš©ìì—ê²Œ 'ê¸ˆìª½ì´'ë¼ëŠ” ì´ë¦„ì˜ ê¸°ë³¸ ì‹ë¬¼ë„ í•¨ê»˜ ìƒì„±ë©ë‹ˆë‹¤.
      requestBody:
        description: íšŒì›ê°€ì…ì— í•„ìš”í•œ ì‚¬ìš©ì ì •ë³´
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UserRegisterRequest'
      responses:
        '200':
          description: íšŒì›ê°€ì… ì„±ê³µ
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UserResponse'
        '400':
          description: í•„ìˆ˜ í•„ë“œê°€ ëˆ„ë½ë˜ì—ˆê±°ë‚˜, ì´ë©”ì¼ ë˜ëŠ” ë‹‰ë„¤ì„ì´ ì´ë¯¸ ì¡´ì¬í•˜ëŠ” ê²½ìš°
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
              example:
                code: 400
                msg: "ì´ë¯¸ ì¡´ì¬í•˜ëŠ” ì´ë©”ì¼ì…ë‹ˆë‹¤."
        '500':
          $ref: '#/components/responses/ServerError'

  /user/login:
    post:
      tags:
        - User
      summary: ì‚¬ìš©ì ë¡œê·¸ì¸
      description: ì´ë©”ì¼ê³¼ ë¹„ë°€ë²ˆí˜¸ë¡œ ì‚¬ìš©ìë¥¼ ì¸ì¦í•˜ê³ , API ì ‘ê·¼ì„ ìœ„í•œ JWT(Access Token)ë¥¼ ë°œê¸‰í•©ë‹ˆë‹¤.
      requestBody:
        description: ë¡œê·¸ì¸ì— í•„ìš”í•œ ì´ë©”ì¼ê³¼ ë¹„ë°€ë²ˆí˜¸
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UserLoginRequest'
      responses:
        '200':
          description: ë¡œê·¸ì¸ ì„±ê³µ. JWT í† í°ì„ ë°˜í™˜í•©ë‹ˆë‹¤.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/TokenResponse'
        '401':
          description: ì´ë©”ì¼ì´ ì¡´ì¬í•˜ì§€ ì•Šê±°ë‚˜ ë¹„ë°€ë²ˆí˜¸ê°€ ì¼ì¹˜í•˜ì§€ ì•ŠëŠ” ê²½ìš°
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
              example:
                code: 401
                msg: "ë¹„ë°€ë²ˆí˜¸ê°€ ì¼ì¹˜í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤."
        '500':
          $ref: '#/components/responses/ServerError'

  /user/email:
    post:
      tags:
        - User
      summary: ì´ë©”ì¼ ì¸ì¦ë²ˆí˜¸ ë°œì†¡
      description: íšŒì›ê°€ì… ì‹œ ë³¸ì¸ ì¸ì¦ì„ ìœ„í•´ ì…ë ¥ëœ ì´ë©”ì¼ ì£¼ì†Œë¡œ 6ìë¦¬ ì¸ì¦ë²ˆí˜¸ë¥¼ ë°œì†¡í•©ë‹ˆë‹¤.
      requestBody:
        description: ì¸ì¦ë²ˆí˜¸ë¥¼ ë°œì†¡í•  ì´ë©”ì¼ ì£¼ì†Œ
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - email
              properties:
                email:
                  type: string
                  format: email
                  description: "ì¸ì¦ë²ˆí˜¸ë¥¼ ë°›ì„ ì´ë©”ì¼ ì£¼ì†Œ"
                  example: "test@example.com"
      responses:
        '200':
          description: ì¸ì¦ë²ˆí˜¸ ë°œì†¡ ì„±ê³µ
          content:
            application/json:
              schema:
                type: object
                properties:
                  code:
                    type: integer
                    example: 200
                  data:
                    type: integer
                    description: "ìƒì„±ëœ 6ìë¦¬ ì¸ì¦ë²ˆí˜¸"
                    example: 123456
                  msg:
                    type: string
                    example: "SendMail"
        '500':
          $ref: '#/components/responses/ServerError'

  /user/token:
    get:
      tags:
        - User
      summary: JWT í† í° ìœ íš¨ì„± ê²€ì¦
      description: HTTP í—¤ë”ì˜ `Authorization` í•„ë“œì— ë‹´ê¸´ JWT í† í°ì„ ê²€ì¦í•˜ê³ , ìœ íš¨í•˜ë‹¤ë©´ í† í°ì— ë‹´ê¸´ ì‚¬ìš©ì ì •ë³´ë¥¼ ë°˜í™˜í•©ë‹ˆë‹¤. (ë¡œê·¸ì¸ ìœ ì§€ í™•ì¸ìš©)
      security:
        - BearerAuth: []
      responses:
        '200':
          description: í† í°ì´ ìœ íš¨í•œ ê²½ìš°, ë””ì½”ë”©ëœ ì‚¬ìš©ì ì •ë³´ë¥¼ ë°˜í™˜í•©ë‹ˆë‹¤.
          content:
            application/json:
              schema:
                type: object
                properties:
                  code:
                    type: integer
                    example: 200
                  data:
                    $ref: '#/components/schemas/DecodedToken'
                  msg:
                    type: string
                    example: "Ok"
        '401':
          $ref: '#/components/responses/UnauthorizedError'

  /user/emotion/{user_id}:
    get:
      tags:
        - User
      summary: ì‚¬ìš©ìì˜ í˜„ì¬ ê°ì • ìƒíƒœ ì¡°íšŒ
      description: íŠ¹ì • ì‚¬ìš©ìì˜ í˜„ì¬ ì„¤ì •ëœ ê°ì •(state) ê°’ì„ ì¡°íšŒí•©ë‹ˆë‹¤.
      parameters:
        - in: path
          name: user_id
          required: true
          schema:
            type: integer
          description: ì¡°íšŒí•  ì‚¬ìš©ìì˜ ID
      responses:
        '200':
          description: ê°ì • ì¡°íšŒ ì„±ê³µ
          content:
            application/json:
              schema:
                type: object
                properties:
                  code:
                    type: integer
                    example: 200
                  data:
                    type: object
                    properties:
                      emotion:
                        type: string
                        description: "ì‚¬ìš©ìì˜ í˜„ì¬ ê°ì • ìƒíƒœ (ì˜ˆ: í–‰ë³µ, ìŠ¬í””)"
                        example: "í–‰ë³µ"
                  msg:
                    type: string
                    example: "Ok"
        '404':
          description: í•´ë‹¹ ì‚¬ìš©ìë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŒ
        '500':
          $ref: '#/components/responses/ServerError'


  # -------------------- Plant API --------------------
  /plant/state/{plant_id}:
    get:
      tags:
        - Plant
      summary: ì‹ë¬¼ì˜ í˜„ì¬ ìƒíƒœ ì¡°íšŒ
      description: ì‹ë¬¼ì˜ IDë¥¼ ì´ìš©í•´ í•´ë‹¹ ì‹ë¬¼ì˜ ì´ë¦„, ë ˆë²¨, ê²½í—˜ì¹˜, í˜¸ê°ë„ë¥¼ í¬í•¨í•œ ì¢…í•©ì ì¸ ìƒíƒœ ì •ë³´ë¥¼ ì¡°íšŒí•©ë‹ˆë‹¤.
      parameters:
        - in: path
          name: plant_id
          required: true
          schema:
            type: integer
          description: ì¡°íšŒí•  ì‹ë¬¼ì˜ ê³ ìœ  ID
          example: 1
      responses:
        '200':
          description: ì‹ë¬¼ ìƒíƒœ ì •ë³´ ì¡°íšŒ ì„±ê³µ
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PlantStateResponse'
        '404':
          description: í•´ë‹¹ ì‹ë¬¼ ë°ì´í„°ë¥¼ ì°¾ì„ ìˆ˜ ì—†ëŠ” ê²½ìš°
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
              example:
                code: 404
                msg: "ì‹ë¬¼ ì •ë³´ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤."
        '500':
          $ref: '#/components/responses/ServerError'

  # -------------------- Chat APIs --------------------
  /chat/plant:
    post:
      tags:
        - Chat
      summary: ì‹ë¬¼ ì±—ë´‡ê³¼ ëŒ€í™”í•˜ê¸°
      description: ì‚¬ìš©ìê°€ ì‹ë¬¼ì—ê²Œ ë©”ì‹œì§€ë¥¼ ë³´ë‚´ê³ , ì±—ë´‡ì˜ ì‘ë‹µì„ ë°›ìŠµë‹ˆë‹¤. ì´ì „ ëŒ€í™” ê¸°ë¡ì„ ë°”íƒ•ìœ¼ë¡œ ë‹µë³€ì´ ìƒì„±ë˜ë©°, ëª¨ë“  ëŒ€í™”ëŠ” DBì— ê¸°ë¡ë©ë‹ˆë‹¤.
      requestBody:
        description: ì±—ë´‡ì—ê²Œ ë³´ë‚¼ ë©”ì‹œì§€ì™€ ì‚¬ìš©ì/ì‹ë¬¼ ì •ë³´
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ChatRequest'
      responses:
        '200':
          description: ì±—ë´‡ì˜ ì‘ë‹µ ì„±ê³µ
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ChatResponse'
        '404':
          description: ìš”ì²­ì— í¬í•¨ëœ ì‚¬ìš©ìë‚˜ ì‹ë¬¼ì„ ì°¾ì„ ìˆ˜ ì—†ëŠ” ê²½ìš°
        '500':
          $ref: '#/components/responses/ServerError'

  /chat/history/{user_id}/{plant_id}:
    get:
      tags:
        - Chat
      summary: íŠ¹ì • ì‹ë¬¼ê³¼ì˜ ì±„íŒ… ê¸°ë¡ ì¡°íšŒ
      description: íŠ¹ì • ì‚¬ìš©ìì™€ íŠ¹ì • ì‹ë¬¼ ê°„ì˜ ì „ì²´ ëŒ€í™” ê¸°ë¡ì„ ì‹œê°„ ìˆœìœ¼ë¡œ ì¡°íšŒí•©ë‹ˆë‹¤.
      parameters:
        - in: path
          name: user_id
          required: true
          schema:
            type: integer
          description: ëŒ€í™” ê¸°ë¡ì„ ì¡°íšŒí•  ì‚¬ìš©ì ID
          example: 1
        - in: path
          name: plant_id
          required: true
          schema:
            type: integer
          description: ëŒ€í™” ê¸°ë¡ì„ ì¡°íšŒí•  ì‹ë¬¼ ID
          example: 1
      responses:
        '200':
          description: ì±„íŒ… ê¸°ë¡ ì¡°íšŒ ì„±ê³µ
          content:
            application/json:
              schema:
                type: object
                properties:
                  code:
                    type: integer
                    example: 200
                  data:
                    type: array
                    items:
                      $ref: '#/components/schemas/ChatHistory'
                  msg:
                    type: string
                    example: "Ok"
        '500':
          $ref: '#/components/responses/ServerError'


  # -------------------- Diary APIs --------------------
  /diary/create:
    post:
      tags:
        - Diary
      summary: ì„±ì¥ ì¼ê¸° ìƒì„± (ì±—ë´‡ ê¸°ë°˜)
      description: ì‚¬ìš©ìì™€ ì±—ë´‡ì˜ í•˜ë£¨ ëŒ€í™” ê¸°ë¡ì„ ë°”íƒ•ìœ¼ë¡œ ìƒˆë¡œìš´ ì„±ì¥ ì¼ê¸°ë¥¼ ìƒì„±í•©ë‹ˆë‹¤. ê°™ì€ ë‚ ì§œì— ë‹¤ì‹œ ìš”ì²­í•˜ë©´ ê¸°ì¡´ ì¼ê¸°ë¥¼ ì—…ë°ì´íŠ¸í•©ë‹ˆë‹¤.
      requestBody:
        description: ì¼ê¸° ìƒì„±ì„ ìœ„í•œ ì‚¬ìš©ì, ì‹ë¬¼ ì •ë³´ ë° íŠ¸ë¦¬ê±° ë©”ì‹œì§€
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/DiaryCreateRequest'
      responses:
        '200':
          description: ì¼ê¸° ìƒì„± ë˜ëŠ” ì—…ë°ì´íŠ¸ ì„±ê³µ. ìƒì„±/ì—…ë°ì´íŠ¸ëœ ì¼ê¸° ë°ì´í„°ë¥¼ ë°˜í™˜í•©ë‹ˆë‹¤.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/DiaryResponse'
        '500':
          $ref: '#/components/responses/ServerError'

  /diary/month/{user_id}/{year_month}:
    get:
      tags:
        - Diary
      summary: íŠ¹ì • ì›”ì˜ ì¼ê¸° ì‘ì„± ë‚ ì§œ ëª©ë¡ ì¡°íšŒ
      description: íŠ¹ì • ì‚¬ìš©ìê°€ ì§€ì •ëœ ì—°ì›”(YYYY-MM)ì— ì‘ì„±í•œ ì¼ê¸°ê°€ ìˆëŠ” ëª¨ë“  ë‚ ì§œë¥¼ ë°°ì—´ë¡œ ë°˜í™˜í•©ë‹ˆë‹¤. (ìº˜ë¦°ë” í‘œê¸°ìš©)
      parameters:
        - in: path
          name: user_id
          required: true
          schema:
            type: integer
          description: "ì‚¬ìš©ì ID"
          example: 1
        - in: path
          name: year_month
          required: true
          schema:
            type: string
          description: "ì¡°íšŒí•  ì—°ì›” (YYYY-MM í˜•ì‹)"
          example: "2025-10"
      responses:
        '200':
          description: ë‚ ì§œ ëª©ë¡ ì¡°íšŒ ì„±ê³µ
          content:
            application/json:
              schema:
                type: object
                properties:
                  code:
                    type: integer
                    example: 200
                  data:
                    type: array
                    items:
                      type: string
                      format: date
                      example: "2025-10-01"
                  msg:
                    type: string
                    example: "Ok"
        '500':
          $ref: '#/components/responses/ServerError'

  /diary/date/{user_id}/{date}:
    get:
      tags:
        - Diary
      summary: íŠ¹ì • ë‚ ì§œì˜ ì¼ê¸° ì¡°íšŒ
      description: íŠ¹ì • ì‚¬ìš©ìê°€ ì§€ì •ëœ ë‚ ì§œ(YYYY-MM-DD)ì— ì‘ì„±í•œ ì¼ê¸°ë¥¼ ì¡°íšŒí•©ë‹ˆë‹¤.
      parameters:
        - in: path
          name: user_id
          required: true
          schema:
            type: integer
          description: "ì‚¬ìš©ì ID"
          example: 1
        - in: path
          name: date
          required: true
          schema:
            type: string
            format: date
          description: "ì¡°íšŒí•  ë‚ ì§œ (YYYY-MM-DD í˜•ì‹)"
          example: "2025-10-01"
      responses:
        '200':
          description: ì¼ê¸° ì¡°íšŒ ì„±ê³µ
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/DiaryResponse'
        '404':
          description: í•´ë‹¹ ë‚ ì§œì— ì‘ì„±ëœ ì¼ê¸°ê°€ ì—†ìŒ
        '500':
          $ref: '#/components/responses/ServerError'

  /comment:
    post:
      tags:
        - Comment
      summary: ìƒˆë¡œìš´ ëŒ“ê¸€ ì‘ì„±
      description: ìš”ì²­ ë³¸ë¬¸ì— í¬í•¨ëœ diary_idì— í•´ë‹¹í•˜ëŠ” ì¼ê¸°ì— ìƒˆë¡œìš´ ëŒ“ê¸€ì„ ì‘ì„±í•©ë‹ˆë‹¤.
      requestBody:
        description: ëŒ“ê¸€ì´ ë‹¬ë¦´ ì¼ê¸° ID, ì‘ì„±ì ID, ê·¸ë¦¬ê³  ëŒ“ê¸€ ë‚´ìš©
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CommentCreateRequest'
      responses:
        '200':
          description: ëŒ“ê¸€ ì‘ì„± ì„±ê³µ. ìƒì„±ëœ ëŒ“ê¸€ ê°ì²´ë¥¼ ë°˜í™˜í•©ë‹ˆë‹¤.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CommentResponse'
        '500':
          $ref: '#/components/responses/ServerError'

  /comment/{diary_id}:
    get:
      tags:
        - Comment
      summary: íŠ¹ì • ì¼ê¸°ì˜ ëª¨ë“  ëŒ“ê¸€ ì¡°íšŒ
      description: ì¼ê¸° IDë¥¼ ì§€ì •í•˜ì—¬ í•´ë‹¹ ì¼ê¸°ì— ë‹¬ë¦° ëª¨ë“  ëŒ“ê¸€ ëª©ë¡ì„ ì¡°íšŒí•©ë‹ˆë‹¤. user_idëŠ” ëŒ“ê¸€ì— ëŒ€í•œ ì‚¬ìš©ìì˜ ì¶”ê°€ ì •ë³´ë¥¼ ìœ„í•´ ì‚¬ìš©ë  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
      parameters:
        - in: path
          name: diary_id
          required: true
          schema:
            type: integer
          description: "ëŒ“ê¸€ì„ ì¡°íšŒí•  ì¼ê¸°ì˜ ID"
          example: 10
        - in: query
          name: user_id
          required: true
          schema:
            type: integer
          description: "ì¡°íšŒí•˜ëŠ” ì‚¬ìš©ìì˜ ID"
          example: 1
      responses:
        '200':
          description: ëŒ“ê¸€ ëª©ë¡ ì¡°íšŒ ì„±ê³µ. ëŒ“ê¸€ ê°ì²´ì˜ ë°°ì—´ì„ ë°˜í™˜í•©ë‹ˆë‹¤.
          content:
            application/json:
              schema:
                type: object
                properties:
                  code:
                    type: integer
                    example: 200
                  data:
                    type: array
                    items:
                      $ref: '#/components/schemas/GrowthDiaryComment'
                  msg:
                    type: string
                    example: "Ok"
        '500':
          $ref: '#/components/responses/ServerError'

  /comment/{comment_id}:
    put:
      tags:
        - Comment
      summary: ëŒ“ê¸€ ìˆ˜ì •
      description: ëŒ“ê¸€ IDë¥¼ ì‚¬ìš©í•˜ì—¬ ê¸°ì¡´ ëŒ“ê¸€ì˜ ë‚´ìš©ì„ ìˆ˜ì •í•©ë‹ˆë‹¤. ì‹¤ì œ ë¡œì§ì€ ìš”ì²­ ë³¸ë¬¸(body)ì— í¬í•¨ëœ comment_idë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤.
      parameters:
        - in: path
          name: comment_id
          required: true
          schema:
            type: integer
          description: "API ê²½ë¡œ êµ¬ë¶„ì„ ìœ„í•œ ëŒ“ê¸€ ID"
          example: 25
      requestBody:
        description: ìˆ˜ì •í•  ëŒ“ê¸€ì˜ ë‚´ìš©ê³¼ ê´€ë ¨ ID ì •ë³´
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CommentUpdateRequest'
      responses:
        '200':
          description: ëŒ“ê¸€ ìˆ˜ì • ì„±ê³µ. ìˆ˜ì •ëœ ëŒ“ê¸€ ê°ì²´ë¥¼ ë°˜í™˜í•©ë‹ˆë‹¤.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CommentResponse'
        '500':
          $ref: '#/components/responses/ServerError'
          
    delete:
      tags:
        - Comment
      summary: ëŒ“ê¸€ ì‚­ì œ
      description: ëŒ“ê¸€ IDë¥¼ ì‚¬ìš©í•˜ì—¬ íŠ¹ì • ëŒ“ê¸€ì„ ì‚­ì œí•©ë‹ˆë‹¤. ì‹¤ì œ ë¡œì§ì€ ìš”ì²­ ë³¸ë¬¸(body)ì— í¬í•¨ëœ comment_idë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤.
      parameters:
        - in: path
          name: comment_id
          required: true
          schema:
            type: integer
          description: "API ê²½ë¡œ êµ¬ë¶„ì„ ìœ„í•œ ëŒ“ê¸€ ID"
          example: 25
      requestBody:
        description: ì‚­ì œí•  ëŒ“ê¸€ì„ ì‹ë³„í•˜ê¸° ìœ„í•œ ID ì •ë³´
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CommentDeleteRequest'
      responses:
        '200':
          description: ëŒ“ê¸€ ì‚­ì œ ì„±ê³µ. ë³„ë„ì˜ ë°ì´í„° ì—†ì´ ì„±ê³µ ë©”ì‹œì§€ë§Œ ë°˜í™˜í•©ë‹ˆë‹¤.
          content:
            application/json:
              schema:
                type: object
                properties:
                  code: { type: integer, example: 200 }
                  msg: { type: string, example: "Ok" }
        '500':
          $ref: '#/components/responses/ServerError'


  # -------------------- Friend APIs --------------------
  /friend/request:
    post:
      tags:
        - Friend
      summary: ì¹œêµ¬ ìš”ì²­ ë³´ë‚´ê¸°
      description: ë‹¤ë¥¸ ì‚¬ìš©ìì—ê²Œ ì¹œêµ¬ ê´€ê³„ë¥¼ ìš”ì²­í•©ë‹ˆë‹¤.
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/FriendRequest'
      responses:
        '200':
          description: ì¹œêµ¬ ìš”ì²­ ì„±ê³µ
        '400':
          description: ìê¸° ìì‹ ì—ê²Œ ìš”ì²­, ì´ë¯¸ ì¹œêµ¬ì´ê±°ë‚˜ ìš”ì²­ ëŒ€ê¸°ì¤‘ì¸ ê²½ìš°
        '404':
          description: ìš”ì²­ì„ ë³´ë‚´ê±°ë‚˜ ë°›ëŠ” ì‚¬ìš©ìë¥¼ ì°¾ì„ ìˆ˜ ì—†ëŠ” ê²½ìš°
        '500':
          $ref: '#/components/responses/ServerError'

  /friend/accept:
    post:
      tags:
        - Friend
      summary: ì¹œêµ¬ ìš”ì²­ ìˆ˜ë½
      description: ë°›ì€ ì¹œêµ¬ ìš”ì²­ì„ ìˆ˜ë½í•˜ì—¬ ì¹œêµ¬ ê´€ê³„ë¥¼ ë§ºìŠµë‹ˆë‹¤.
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/FriendRequest' # FriendRequest ìŠ¤í‚¤ë§ˆ ì¬ì‚¬ìš©
      responses:
        '200':
          description: ì¹œêµ¬ ìš”ì²­ ìˆ˜ë½ ì„±ê³µ
        '400':
          description: í•´ë‹¹ ì¹œêµ¬ ìš”ì²­ì´ ì¡´ì¬í•˜ì§€ ì•ŠëŠ” ê²½ìš°
        '500':
          $ref: '#/components/responses/ServerError'

  /friend/{user_id}:
    get:
      tags:
        - Friend
      summary: ì¹œêµ¬ ëª©ë¡ ì¡°íšŒ
      description: íŠ¹ì • ì‚¬ìš©ìì˜ ëª¨ë“  ì¹œêµ¬ ëª©ë¡ì„ ì¡°íšŒí•©ë‹ˆë‹¤.
      parameters:
        - in: path
          name: user_id
          required: true
          schema:
            type: integer
      responses:
        '200':
          description: ì¹œêµ¬ ëª©ë¡ ì¡°íšŒ ì„±ê³µ
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/FriendInfo'
        '500':
          $ref: '#/components/responses/ServerError'

  # -------------------- Mission APIs --------------------
  /mission/{user_id}:
    get:
      tags:
        - Mission
      summary: ì˜¤ëŠ˜ì˜ ë¯¸ì…˜ ì¡°íšŒ
      description: íŠ¹ì • ì‚¬ìš©ìì˜ ì˜¤ëŠ˜ ë‚ ì§œ ë¯¸ì…˜ ë‚´ìš©ê³¼ ì™„ë£Œ ì—¬ë¶€ë¥¼ ì¡°íšŒí•©ë‹ˆë‹¤.
      parameters:
        - in: path
          name: user_id
          required: true
          schema:
            type: integer
      responses:
        '200':
          description: ë¯¸ì…˜ ì¡°íšŒ ì„±ê³µ
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/MissionResponse'
        '500':
          $ref: '#/components/responses/ServerError'

  /mission/complete:
    post:
      tags:
        - Mission
      summary: ë¯¸ì…˜ ì™„ë£Œ ì²˜ë¦¬
      description: ì‚¬ìš©ìì˜ ì˜¤ëŠ˜ì˜ ë¯¸ì…˜ì„ ì™„ë£Œ ìƒíƒœë¡œ ë³€ê²½í•©ë‹ˆë‹¤.
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [user_id]
              properties:
                user_id:
                  type: integer
      responses:
        '200':
          description: ë¯¸ì…˜ ì™„ë£Œ ì²˜ë¦¬ ì„±ê³µ
        '400':
          description: ì´ë¯¸ ì™„ë£Œëœ ë¯¸ì…˜ì¸ ê²½ìš°
        '500':
          $ref: '#/components/responses/ServerError'

  # -------------------- Speech APIs --------------------
  /speech/stt:
    post:
      tags:
        - Speech
      summary: ìŒì„±ì„ í…ìŠ¤íŠ¸ë¡œ ë³€í™˜ (STT)
      description: OGG(Opus) í˜•ì‹ì˜ ìŒì„± íŒŒì¼ì„ ë°›ì•„ í…ìŠ¤íŠ¸ë¡œ ë³€í™˜í•©ë‹ˆë‹¤.
      requestBody:
        required: true
        content:
          multipart/form-data:
            schema:
              type: object
              properties:
                file:
                  type: string
                  format: binary
                  description: "OGG_OPUS ì¸ì½”ë”©, 16000Hz ìƒ˜í”Œë§ ë ˆì´íŠ¸ì˜ ìŒì„± íŒŒì¼"
                user_id:
                  type: integer
                plant_id:
                  type: integer
      responses:
        '200':
          description: STT ë³€í™˜ ì„±ê³µ
          content:
            application/json:
              schema:
                type: object
                properties:
                  code: { type: integer, example: 200 }
                  data:
                    type: string
                    description: "ë³€í™˜ëœ í…ìŠ¤íŠ¸"
                    example: "ì˜¤ëŠ˜ ë‚ ì”¨ ì •ë§ ì¢‹ë‹¤."
                  msg: { type: string, example: "Ok" }
        '400':
          description: ìŒì„± íŒŒì¼ì´ ì²¨ë¶€ë˜ì§€ ì•Šì€ ê²½ìš°
        '500':
          $ref: '#/components/responses/ServerError'

  /speech/tts:
    post:
      tags:
        - Speech
      summary: í…ìŠ¤íŠ¸ë¥¼ ìŒì„±ìœ¼ë¡œ ë³€í™˜ (TTS)
      description: ì…ë ¥ëœ í…ìŠ¤íŠ¸ ë©”ì‹œì§€ë¥¼ OGG í˜•ì‹ì˜ ìŒì„± íŒŒì¼(Blob)ìœ¼ë¡œ ë³€í™˜í•˜ì—¬ ë°˜í™˜í•©ë‹ˆë‹¤.
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [message]
              properties:
                message:
                  type: string
                  description: "ìŒì„±ìœ¼ë¡œ ë³€í™˜í•  í…ìŠ¤íŠ¸"
                  example: "ì˜¤ëŠ˜ í•˜ë£¨ë„ ìˆ˜ê³  ë§ìœ¼ì…¨ì–´ìš”."
      responses:
        '200':
          description: TTS ë³€í™˜ ì„±ê³µ. audio/ogg í˜•ì‹ì˜ Blob ë°ì´í„°ë¥¼ ë°˜í™˜í•©ë‹ˆë‹¤.
          content:
            audio/ogg:
              schema:
                type: string
                format: binary
        '400':
          description: ë³€í™˜í•  ë©”ì‹œì§€ê°€ ì—†ëŠ” ê²½ìš°
        '500':
          $ref: '#/components/responses/ServerError'


# ===============================================================
# == Components (ì „ì²´ ê¸°ëŠ¥ ìµœì¢… í†µí•©ë³¸)
# ===============================================================
components:
  # -------------------- Security Schemes --------------------
  securitySchemes:
    BearerAuth:
      type: http
      scheme: bearer
      bearerFormat: JWT
      description: "ë¡œê·¸ì¸ ì‹œ ë°œê¸‰ë°›ì€ JWT í† í°ì„ 'Bearer {token}' í˜•ì‹ìœ¼ë¡œ ì…ë ¥í•˜ì„¸ìš”."

  # -------------------- Schemas (ëª¨ë“  ëª¨ë¸/ìš”ì²­/ì‘ë‹µ) --------------------
  schemas:
    # -------------------- User Schemas --------------------
    User:
      type: object
      description: ì‚¬ìš©ì ì •ë³´ ìŠ¤í‚¤ë§ˆ (DB ëª¨ë¸ ê¸°ì¤€)
      properties:
        user_id:
          type: integer
          description: "ì‚¬ìš©ì ê³ ìœ  ID"
          readOnly: true
        user_email:
          type: string
          format: email
        user_name:
          type: string
        user_gender:
          type: string
        state:
          type: string
          description: "ì‚¬ìš©ìì˜ í˜„ì¬ ê°ì • ìƒíƒœ (ì˜ˆ: í–‰ë³µ, ìŠ¬í””, ì¤‘ë¦½)"
          nullable: true
        created_at:
          type: string
          format: date-time
          description: "ê³„ì • ìƒì„±ì¼"
          readOnly: true

    UserRegisterRequest:
      type: object
      description: íšŒì›ê°€ì… ìš”ì²­ ì‹œ Bodyì— í¬í•¨ë  ë°ì´í„°
      required:
        - user_name
        - user_email
        - password
        - user_gender
      properties:
        user_name:
          type: string
          example: "ê¹€Inner"
        user_email:
          type: string
          format: email
          example: "innerecho@example.com"
        password:
          type: string
          format: password
          description: "ì•”í˜¸í™”ë˜ì–´ ì €ì¥ë  ì‚¬ìš©ì ë¹„ë°€ë²ˆí˜¸"
          example: "password123!"
        user_gender:
          type: string
          example: "ë‚¨ì„±"

    UserLoginRequest:
      type: object
      description: ë¡œê·¸ì¸ ìš”ì²­ ì‹œ Bodyì— í¬í•¨ë  ë°ì´í„°
      required:
        - user_email
        - password
      properties:
        user_email:
          type: string
          format: email
          example: "innerecho@example.com"
        password:
          type: string
          format: password
          example: "password123!"

    DecodedToken:
      type: object
      description: JWT í† í°ì„ ë””ì½”ë”©í–ˆì„ ë•Œ ì–»ì„ ìˆ˜ ìˆëŠ” ì‚¬ìš©ì ì •ë³´ í˜ì´ë¡œë“œ
      properties:
        user_id:
          type: integer
        user_email:
          type: string
          format: email
        user_name:
          type: string
        state:
          type: string
          nullable: true
        plant_id:
          type: integer
          description: "ì‚¬ìš©ìê°€ ì†Œìœ í•œ ê¸°ë³¸ ì‹ë¬¼ì˜ ID"
        nickname:
          type: string
          description: "ì‚¬ìš©ìê°€ ì†Œìœ í•œ ê¸°ë³¸ ì‹ë¬¼ì˜ ì´ë¦„"

    # -------------------- Plant & Chat Schemas --------------------
    UserPlant:
      type: object
      description: ì‚¬ìš©ìê°€ ì†Œìœ í•œ ì‹ë¬¼ ì •ë³´ ìŠ¤í‚¤ë§ˆ (DB ëª¨ë¸ ê¸°ì¤€)
      properties:
        plant_id:
          type: integer
          readOnly: true
        user_id:
          type: integer
        species_id:
          type: integer
        nickname:
          type: string
          description: "ì‹ë¬¼ì˜ ì• ì¹­"
          example: "ê¸ˆìª½ì´"
        plant_level:
          type: integer
          description: "ì‹ë¬¼ ë ˆë²¨"
          example: 1
        plant_experience:
          type: integer
          description: "ì‹ë¬¼ ê²½í—˜ì¹˜"
          example: 50
        plant_hogamdo:
          type: integer
          description: "ì‹ë¬¼ê³¼ì˜ í˜¸ê°ë„"
          example: 10
        last_measured_date:
          type: string
          format: date-time
          description: "ë§ˆì§€ë§‰ìœ¼ë¡œ ìƒíƒœë¥¼ ì¸¡ì •í•œ ë‚ ì§œ"

    ChatHistory:
      type: object
      description: ì±„íŒ… ê¸°ë¡ ìŠ¤í‚¤ë§ˆ (DB ëª¨ë¸ ê¸°ì¤€)
      properties:
        history_id:
          type: integer
          readOnly: true
        message:
          type: string
        user_id:
          type: integer
        plant_id:
          type: integer
        send_date:
          type: string
          format: date-time
        user_type:
          type: string
          enum: [User, Bot]
          description: "ë©”ì‹œì§€ ë°œì‹ ì (ì‚¬ìš©ì ë˜ëŠ” ì±—ë´‡)"

    ChatRequest:
      type: object
      description: ì±—ë´‡ì—ê²Œ ë©”ì‹œì§€ ì „ì†¡ ì‹œ Bodyì— í¬í•¨ë  ë°ì´í„°
      required:
        - user_id
        - plant_id
        - message
      properties:
        user_id:
          type: integer
          description: "ë©”ì‹œì§€ë¥¼ ë³´ë‚´ëŠ” ì‚¬ìš©ì ID"
          example: 1
        plant_id:
          type: integer
          description: "ëŒ€í™”í•  ì‹ë¬¼ ID"
          example: 1
        message:
          type: string
          description: "ì‚¬ìš©ìê°€ ì…ë ¥í•œ ë©”ì‹œì§€"
          example: "ì˜¤ëŠ˜ í•˜ë£¨ ì–´ë• ì–´?"
        emotion:
          type: string
          description: "(ì„ íƒ) ì‚¬ìš©ìì˜ í˜„ì¬ ê°ì • ìƒíƒœ. ì±—ë´‡ ë‹µë³€ì— ì˜í–¥ì„ ì¤„ ìˆ˜ ìˆìŠµë‹ˆë‹¤."
          nullable: true
          example: "í–‰ë³µ"

    # -------------------- Diary Schemas --------------------
    GrowthDiary:
      type: object
      description: ì„±ì¥ ì¼ê¸° ìŠ¤í‚¤ë§ˆ (DB ëª¨ë¸ ê¸°ì¤€)
      properties:
        diary_id:
          type: integer
          readOnly: true
        user_id:
          type: integer
        title:
          type: string
          example: "ê¸ˆìª½ì´ì™€ì˜ í•˜ë£¨"
        content:
          type: string
          example: "ì˜¤ëŠ˜ ê¸ˆìª½ì´ì™€ ë§ì€ ì´ì•¼ê¸°ë¥¼ ë‚˜ëˆ„ì—ˆë‹¤. í–‰ë³µí•œ í•˜ë£¨ì˜€ë‹¤."
        image_url:
          type: string
          nullable: true
        created_at:
          type: string
          format: date-time
        updated_at:
          type: string
          format: date-time
        is_deleted:
          type: boolean
        edited:
          type: boolean

    DiaryCreateRequest:
      type: object
      required: [user_id, plant_id, message]
      properties:
        user_id:
          type: integer
          example: 1
        plant_id:
          type: integer
          example: 1
        message:
          type: string
          example: "ì˜¤ëŠ˜ í•˜ë£¨ë¥¼ ì¼ê¸°ë¡œ ë§Œë“¤ì–´ì¤˜."

    # -------------------- Comment Schemas --------------------
    GrowthDiaryComment:
      type: object
      description: ì„±ì¥ ì¼ê¸° ëŒ“ê¸€ ìŠ¤í‚¤ë§ˆ (DB ëª¨ë¸ ê¸°ì¤€)
      properties:
        comment_id:
          type: integer
        diary_id:
          type: integer
        user_id:
          type: integer
        content:
          type: string
        created_at:
          type: string
          format: date-time
        updated_at:
          type: string
          format: date-time

    CommentCreateRequest:
      type: object
      required: [diary_id, user_id, content]
      properties:
        diary_id:
          type: integer
        user_id:
          type: integer
        content:
          type: string

    CommentUpdateRequest:
      type: object
      required: [user_id, diary_id, comment_id, content]
      properties:
        user_id:
          type: integer
        diary_id:
          type: integer
        comment_id:
          type: integer
        content:
          type: string

    CommentDeleteRequest:
      type: object
      required: [user_id, diary_id, comment_id]
      properties:
        user_id:
          type: integer
        diary_id:
          type: integer
        comment_id:
          type: integer

    # -------------------- Response Schemas --------------------
    UserResponse:
      type: object
      description: ì‚¬ìš©ì ê´€ë ¨ APIì˜ ê¸°ë³¸ ì„±ê³µ ì‘ë‹µ
      properties:
        code:
          type: integer
          example: 200
        data:
          $ref: '#/components/schemas/User'
        msg:
          type: string
          example: "Ok"

    TokenResponse:
      type: object
      description: ë¡œê·¸ì¸ ì„±ê³µ ì‹œ ë°˜í™˜ë˜ëŠ” JWT í† í° ì‘ë‹µ
      properties:
        code:
          type: integer
          example: 200
        data:
          type: string
          description: "API ì¸ì¦ì— ì‚¬ìš©ë  JWT Access Token"
          example: "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VyX2lkIjoxLCJpYXQiOjE2MTYyMzkwMjJ9.SflKxwRJSMeKKF2QT4fwpMeJf36POk6yJV_adQssw5c"
        msg:
          type: string
          example: "Ok"

    PlantStateResponse:
      type: object
      description: ì‹ë¬¼ ìƒíƒœ ì¡°íšŒ ì„±ê³µ ì‘ë‹µ
      properties:
        code:
          type: integer
          example: 200
        data:
          type: object
          properties:
            plant_name:
              type: string
              description: "ì‹ë¬¼ ì• ì¹­"
              example: "ê¸ˆìª½ì´"
            level:
              type: integer
              example: 1
            experience:
              type: integer
              example: 50
            likeability:
              type: integer
              description: "í˜¸ê°ë„"
              example: 10
        msg:
          type: string
          example: "Ok"

    ChatResponse:
      type: object
      description: ì±—ë´‡ ëŒ€í™” ì„±ê³µ ì‘ë‹µ
      properties:
        code:
          type: integer
          example: 200
        data:
          type: object
          properties:
            user_id:
              type: integer
              example: 1
            plant_id:
              type: integer
              example: 1
            message:
              type: string
              description: "ì±—ë´‡ì˜ ì‘ë‹µ ë©”ì‹œì§€"
              example: "ì˜¤ëŠ˜ í•˜ë£¨ë„ ì •ë§ ì¦ê±°ì› ì–´ìš”! ì£¼ì¸ë‹˜ì€ ì–´ë– ì…¨ë‚˜ìš”?"
            user_type:
              type: string
              example: "Bot"
            send_date:
              type: string
              format: date-time
        msg:
          type: string
          example: "Ok"

    DiaryResponse:
      type: object
      description: ì¼ê¸° ìƒì„± ë° ì¡°íšŒ ì„±ê³µ ì‘ë‹µ
      properties:
        code:
          type: integer
          example: 200
        data:
          $ref: '#/components/schemas/GrowthDiary'
        msg:
          type: string
          example: "Ok"

    CommentResponse:
      type: object
      description: ëŒ“ê¸€ ìƒì„± ë° ìˆ˜ì • ì„±ê³µ ì‘ë‹µ
      properties:
        code:
          type: integer
          example: 200
        data:
          $ref: '#/components/schemas/GrowthDiaryComment'
        msg:
          type: string
          example: "Ok"

    ErrorResponse:
      type: object
      description: API ì‹¤íŒ¨ ì‹œ ê³µí†µ ì‘ë‹µ
      properties:
        code:
          type: integer
        msg:
          type: string
    FriendRequest:
      type: object
      required: [from_user_id, to_user_id]
      properties:
        from_user_id:
          type: integer
          description: "ìš”ì²­ì„ ë³´ë‚´ëŠ” ì‚¬ìš©ì ID"
        to_user_id:
          type: integer
          description: "ìš”ì²­ì„ ë°›ëŠ” ì‚¬ìš©ì ID"

    FriendInfo:
      type: object
      description: ì¹œêµ¬ ëª©ë¡ì— í‘œì‹œë  ì‚¬ìš©ì ì •ë³´
      properties:
        user_id:
          type: integer
        user_name:
          type: string
        state:
          type: string
          description: "ì¹œêµ¬ì˜ í˜„ì¬ ê°ì • ìƒíƒœ"

    Mission:
      type: object
      properties:
        mission_id:
          type: integer
        content:
          type: string
          example: "ì‹ë¬¼ì—ê²Œ ë§ ê±¸ê¸°"
        is_completed:
          type: boolean

    MissionResponse:
      type: object
      properties:
        code:
          type: integer
          example: 200
        data:
          $ref: '#/components/schemas/Mission'
        msg:
          type: string
          example: "Ok"

    ErrorResponse:
      type: object
      properties:
        code:
          type: integer
        msg:
          type: string


  # -------------------- Responses (ê³µí†µ ì‘ë‹µ) --------------------
  responses:
    ServerError:
      description: ì„œë²„ ë‚´ë¶€ ì˜¤ë¥˜
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/ErrorResponse'
          example:
            code: 500
            msg: "ServerError"
            
    UnauthorizedError:
      description: ì¸ì¦ ì‹¤íŒ¨ (í† í°ì´ ì—†ê±°ë‚˜ ìœ íš¨í•˜ì§€ ì•ŠìŒ)
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/ErrorResponse'
          example:
            code: 401
            msg: "ìœ íš¨í•˜ì§€ ì•Šì€ í† í°ì…ë‹ˆë‹¤."