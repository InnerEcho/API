services:
  # Node.js API 서비스
  leafy_api:
    build:
      context: . # 👈 경로 수정: 현재 폴더(leafy)를 기준으로 빌드
    container_name: leafy_api_container # 👈 이름 변경: 충돌 방지
    env_file:
      - ./.env # 👈 경로 수정: 현재 폴더의 .env 파일 사용
    ports:
      - "3001:3001" # 👈 포트 노출: 직접 접속을 위해 포트를 열어줌
    restart: unless-stopped
    # networks는 Docker Compose가 자동으로 생성하는 기본 네트워크를 사용

  # 🐘 Leafy DB 서비스
  leafy_db:
    image: mysql:8.0
    container_name: leafy_db_container # 👈 이름 변경: 충돌 방지
    command: --default-authentication-plugin=mysql_native_password
    restart: always
    env_file:
      - ./.env # 👈 경로 수정: 현재 폴더의 .env 파일 사용
    volumes:
      - leafy_db_volumes:/var/lib/mysql # 👈 볼륨 이름 변경: 충돌 방지


# DB 데이터를 영속적으로 저장하기 위한 Docker 볼륨을 정의합니다.
volumes:
  leafy_db_volumes: